{
  "version": "1.0",
  "conceptualSchemaSettings": {},
  "queries": [
    {
      "name": "dCliente",
      "lineageTag": "959c086f-c05a-40a4-9b78-8d177ea2b7fa",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "        Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\", [Query=\"SELECT A.*, B.[TIPO DE CONTA] FROM DIM_CLIENTE_BI A#(lf)LEFT JOIN DIM_EMITENTE_BI B ON B.DIM_EMITENTE_ID = A.DIM_CLIENTE_ID\"]),",
        "    #\"Colunas Renomeadas3\" = Table.RenameColumns(Fonte,{{\"CLIENTE\", \"NOME ABREV\"}}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Colunas Renomeadas3\", \"Cod - Desc. Cliente\", each Text.Combine({Text.From([COD_CLIENTE], \"pt-BR\"), [CLIENTE]}, \" - \"), type text),",
        "    #\"Coluna Duplicada\" = Table.DuplicateColumn(#\"Coluna Mesclada Inserida\", \"NOME ABREV\", \"CLIENTE - Copiar\"),",
        "    #\"Dividir Coluna por Delimitador\" = Table.SplitColumn(#\"Coluna Duplicada\", \"CLIENTE - Copiar\", Splitter.SplitTextByDelimiter(\" \", QuoteStyle.Csv), {\"CLIENTE - Copiar.1\", \"CLIENTE - Copiar.2\", \"CLIENTE - Copiar.3\", \"CLIENTE - Copiar.4\", \"CLIENTE - Copiar.5\"}),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Dividir Coluna por Delimitador\",{{\"CLIENTE - Copiar.1\", type text}, {\"CLIENTE - Copiar.2\", type text}, {\"CLIENTE - Copiar.3\", type text}, {\"CLIENTE - Copiar.4\", type text}, {\"CLIENTE - Copiar.5\", Int64.Type}}),",
        "    #\"Texto em Maiúscula\" = Table.TransformColumns(#\"Tipo Alterado\",{{\"CIDADE\", RemoveAcento, type text}}),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Texto em Maiúscula\",{\"CLIENTE - Copiar.2\", \"CLIENTE - Copiar.3\", \"CLIENTE - Copiar.4\", \"CLIENTE - Copiar.5\", \"Cod - Desc. Cliente\"}),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Colunas Removidas\",{{\"CLIENTE - Copiar.1\", \"Matriz\"}}),",
        "    #\"Coluna Mesclada Inserida1\" = Table.AddColumn(#\"Colunas Renomeadas\", \"Mesclado\", each Text.Combine({[CIDADE], \", \", [ESTADO], \", BR\"}), type text),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"Coluna Mesclada Inserida1\",{{\"Mesclado\", \"ID Cidade/Estado\"}}),",
        "    #\"Colocar Cada Palavra Em Maiúscula\" = Table.TransformColumns(#\"Colunas Renomeadas1\",{{\"ID Cidade/Estado\", Text.Proper, type text}}),",
        "    #\"Valor Substituído\" = Table.ReplaceValue(#\"Colocar Cada Palavra Em Maiúscula\",\"ç\",\"c\",Replacer.ReplaceText,{\"ID Cidade/Estado\"}),",
        "    #\"Valor Substituído1\" = Table.ReplaceValue(#\"Valor Substituído\",null,\"\",Replacer.ReplaceValue,{\"ESTADO\"}),",
        "    #\"Valor Substituído2\" = Table.ReplaceValue(#\"Valor Substituído1\",null,\"\",Replacer.ReplaceValue,{\"CIDADE\"}),",
        "    #\"Colunas Renomeadas2\" = Table.RenameColumns(#\"Valor Substituído2\",{{\"NOME ABREV\", \"CLIENTE\"}}),",
        "    #\"Erros Substituídos\" = Table.ReplaceErrorValues(#\"Colunas Renomeadas2\", {{\"CIDADE\", \"\"}}),",
        "    #\"Erros Substituídos1\" = Table.ReplaceErrorValues(#\"Erros Substituídos\", {{\"ID Cidade/Estado\", \"\"}}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Erros Substituídos1\",{{\"Matriz\", \"Matriz\"}, {\"MATRIZ\", \"MATRIZ 2\"}}),",
        "    #\"Duplicated Column\" = Table.DuplicateColumn(#\"Renamed Columns\", \"Matriz\", \"Matriz - Copy\"),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Duplicated Column\",{\"Matriz - Copy\"}),",
        "    #\"Valor Substituído4\" = Table.ReplaceValue(#\"Removed Columns\",null,\"\",Replacer.ReplaceValue,{\"MATRIZ 2\"}),",
        "    #\"Added Custom\" = Table.AddColumn(#\"Valor Substituído4\", \"DESC MATRIZ\", each Text.Combine(List.RemoveItems(Text.ToList([MATRIZ 2]),{\"0\"..\"9\"}))),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"DESC MATRIZ\", type text}}),",
        "    #\"Inserted Merged Column\" = Table.AddColumn(#\"Changed Type\", \"Merged\", each Text.Combine({[COD_CLIENTE], \" - \", [CLIENTE]}), type text),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Inserted Merged Column\",{{\"Merged\", \"COD DESC\"}}),",
        "    #\"Added Conditional Column\" = Table.AddColumn(#\"Renamed Columns1\", \"Classificação\", each if [Matriz] = \"BRACELL\" then \"Key Account\" else if [Matriz] = \"CENIBRA\" then \"Key Account\" else if [Matriz] = \"DURATEX\" then \"Key Account\" else if [Matriz] = \"DEXCO\" then \"Key Account\" else if [Matriz] = \"ELDORADO\" then \"Key Account\" else if [Matriz] = \"KLABIN\" then \"Key Account\" else if [Matriz] = \"LD\" then \"Key Account\" else if [Matriz] = \"SUZANO\" then \"Key Account\" else if [Matriz] = \"SYLVAMO\" then \"Key Account\" else if [Matriz] = \"VERACEL\" then \"Key Account\" else if [Matriz] = \"WESTROCK\" then \"Key Account\" else \"Retail\", type text),",
        "    #\"Added Custom1\" = Table.AddColumn(#\"Added Conditional Column\", \"COD DESC END\", each [COD DESC] & \" \" & [#\"ID Cidade/Estado\"])",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Added Custom1\",{\"CIDADE\",\"TIPO_CLIENTE\",\"condicao_pagamento\",\"SEGMENTO_MERCADO\",\"ins-banc\",\"COD_SEG_MERCADO\",\"CREDITO\",\"IDENTIFIC\",\"AVALIACAO_CREDITO\",\"LIMITE_CREDITO\",\"DATA_LIMITE_CREDITO\",\"COD_COND_PAG\",\"port-prefer\",\"portador\",\"tp-rec-padrao\",\"LIMITE_ADICIONAL\"})",
        ",",
        "#\"Columns removed by Measure Killer 2\"= Table.RemoveColumns(#\"Columns removed by Measure Killer\",{\"PAIS\",\"FL_GRANDES_CONTAS\"})",
        "in",
        "#\"Columns removed by Measure Killer 2\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n        Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\", [Query=\\\"SELECT A.*, B.[TIPO DE CONTA] FROM DIM_CLIENTE_BI A#(lf)LEFT JOIN DIM_EMITENTE_BI B ON B.DIM_EMITENTE_ID = A.DIM_CLIENTE_ID\\\"]),\\r\\n    #\\\"Colunas Renomeadas3\\\" = Table.RenameColumns(Fonte,{{\\\"CLIENTE\\\", \\\"NOME ABREV\\\"}}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Colunas Renomeadas3\\\", \\\"Cod - Desc. Cliente\\\", each Text.Combine({Text.From([COD_CLIENTE], \\\"pt-BR\\\"), [CLIENTE]}, \\\" - \\\"), type text),\\r\\n    #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(#\\\"Coluna Mesclada Inserida\\\", \\\"NOME ABREV\\\", \\\"CLIENTE - Copiar\\\"),\\r\\n    #\\\"Dividir Coluna por Delimitador\\\" = Table.SplitColumn(#\\\"Coluna Duplicada\\\", \\\"CLIENTE - Copiar\\\", Splitter.SplitTextByDelimiter(\\\" \\\", QuoteStyle.Csv), {\\\"CLIENTE - Copiar.1\\\", \\\"CLIENTE - Copiar.2\\\", \\\"CLIENTE - Copiar.3\\\", \\\"CLIENTE - Copiar.4\\\", \\\"CLIENTE - Copiar.5\\\"}),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Dividir Coluna por Delimitador\\\",{{\\\"CLIENTE - Copiar.1\\\", type text}, {\\\"CLIENTE - Copiar.2\\\", type text}, {\\\"CLIENTE - Copiar.3\\\", type text}, {\\\"CLIENTE - Copiar.4\\\", type text}, {\\\"CLIENTE - Copiar.5\\\", Int64.Type}}),\\r\\n    #\\\"Texto em Maiúscula\\\" = Table.TransformColumns(#\\\"Tipo Alterado\\\",{{\\\"CIDADE\\\", RemoveAcento, type text}}),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Texto em Maiúscula\\\",{\\\"CLIENTE - Copiar.2\\\", \\\"CLIENTE - Copiar.3\\\", \\\"CLIENTE - Copiar.4\\\", \\\"CLIENTE - Copiar.5\\\", \\\"Cod - Desc. Cliente\\\"}),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Colunas Removidas\\\",{{\\\"CLIENTE - Copiar.1\\\", \\\"Matriz\\\"}}),\\r\\n    #\\\"Coluna Mesclada Inserida1\\\" = Table.AddColumn(#\\\"Colunas Renomeadas\\\", \\\"Mesclado\\\", each Text.Combine({[CIDADE], \\\", \\\", [ESTADO], \\\", BR\\\"}), type text),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida1\\\",{{\\\"Mesclado\\\", \\\"ID Cidade/Estado\\\"}}),\\r\\n    #\\\"Colocar Cada Palavra Em Maiúscula\\\" = Table.TransformColumns(#\\\"Colunas Renomeadas1\\\",{{\\\"ID Cidade/Estado\\\", Text.Proper, type text}}),\\r\\n    #\\\"Valor Substituído\\\" = Table.ReplaceValue(#\\\"Colocar Cada Palavra Em Maiúscula\\\",\\\"ç\\\",\\\"c\\\",Replacer.ReplaceText,{\\\"ID Cidade/Estado\\\"}),\\r\\n    #\\\"Valor Substituído1\\\" = Table.ReplaceValue(#\\\"Valor Substituído\\\",null,\\\"\\\",Replacer.ReplaceValue,{\\\"ESTADO\\\"}),\\r\\n    #\\\"Valor Substituído2\\\" = Table.ReplaceValue(#\\\"Valor Substituído1\\\",null,\\\"\\\",Replacer.ReplaceValue,{\\\"CIDADE\\\"}),\\r\\n    #\\\"Colunas Renomeadas2\\\" = Table.RenameColumns(#\\\"Valor Substituído2\\\",{{\\\"NOME ABREV\\\", \\\"CLIENTE\\\"}}),\\r\\n    #\\\"Erros Substituídos\\\" = Table.ReplaceErrorValues(#\\\"Colunas Renomeadas2\\\", {{\\\"CIDADE\\\", \\\"\\\"}}),\\r\\n    #\\\"Erros Substituídos1\\\" = Table.ReplaceErrorValues(#\\\"Erros Substituídos\\\", {{\\\"ID Cidade/Estado\\\", \\\"\\\"}}),\\r\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Erros Substituídos1\\\",{{\\\"Matriz\\\", \\\"Matriz\\\"}, {\\\"MATRIZ\\\", \\\"MATRIZ 2\\\"}}),\\r\\n    #\\\"Duplicated Column\\\" = Table.DuplicateColumn(#\\\"Renamed Columns\\\", \\\"Matriz\\\", \\\"Matriz - Copy\\\"),\\r\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Duplicated Column\\\",{\\\"Matriz - Copy\\\"}),\\r\\n    #\\\"Valor Substituído4\\\" = Table.ReplaceValue(#\\\"Removed Columns\\\",null,\\\"\\\",Replacer.ReplaceValue,{\\\"MATRIZ 2\\\"}),\\r\\n    #\\\"Added Custom\\\" = Table.AddColumn(#\\\"Valor Substituído4\\\", \\\"DESC MATRIZ\\\", each Text.Combine(List.RemoveItems(Text.ToList([MATRIZ 2]),{\\\"0\\\"..\\\"9\\\"}))),\\r\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(#\\\"Added Custom\\\",{{\\\"DESC MATRIZ\\\", type text}}),\\r\\n    #\\\"Inserted Merged Column\\\" = Table.AddColumn(#\\\"Changed Type\\\", \\\"Merged\\\", each Text.Combine({[COD_CLIENTE], \\\" - \\\", [CLIENTE]}), type text),\\r\\n    #\\\"Renamed Columns1\\\" = Table.RenameColumns(#\\\"Inserted Merged Column\\\",{{\\\"Merged\\\", \\\"COD DESC\\\"}}),\\r\\n    #\\\"Added Conditional Column\\\" = Table.AddColumn(#\\\"Renamed Columns1\\\", \\\"Classificação\\\", each if [Matriz] = \\\"BRACELL\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"CENIBRA\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"DURATEX\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"DEXCO\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"ELDORADO\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"KLABIN\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"LD\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"SUZANO\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"SYLVAMO\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"VERACEL\\\" then \\\"Key Account\\\" else if [Matriz] = \\\"WESTROCK\\\" then \\\"Key Account\\\" else \\\"Retail\\\", type text),\\r\\n    #\\\"Added Custom1\\\" = Table.AddColumn(#\\\"Added Conditional Column\\\", \\\"COD DESC END\\\", each [COD DESC] & \\\" \\\" & [#\\\"ID Cidade/Estado\\\"])\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Added Custom1\\\",{\\\"CIDADE\\\",\\\"TIPO_CLIENTE\\\",\\\"condicao_pagamento\\\",\\\"SEGMENTO_MERCADO\\\",\\\"ins-banc\\\",\\\"COD_SEG_MERCADO\\\",\\\"CREDITO\\\",\\\"IDENTIFIC\\\",\\\"AVALIACAO_CREDITO\\\",\\\"LIMITE_CREDITO\\\",\\\"DATA_LIMITE_CREDITO\\\",\\\"COD_COND_PAG\\\",\\\"port-prefer\\\",\\\"portador\\\",\\\"tp-rec-padrao\\\",\\\"LIMITE_ADICIONAL\\\"})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer 2\\\"= Table.RemoveColumns(#\\\"Columns removed by Measure Killer\\\",{\\\"PAIS\\\",\\\"FL_GRANDES_CONTAS\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer 2\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dItem",
      "lineageTag": "b70b149f-b2e3-4899-9df6-23639035b115",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"BRPIN-DBS008\\PowerBI\", \"idba_komatsu\", [Query=\"SELECT I.[DIM_ITEM_ID]#(lf)      ,I.[CD_ITEM]#(lf)      ,I.[NM_ITEM]#(lf)      ,I.[DESC_C1]#(lf)      ,I.[DESC_C2]#(lf)      ,I.[DESC_C3]#(lf)      ,I.[DESC_C4]#(lf)      ,I.[COD_C1]#(lf)      ,I.[COD_C2]#(lf)      ,I.[COD_C3]#(lf)      ,I.[COD_C4]#(lf)      ,I.[NM_CD_UM_ITEM]#(lf)      ,I.[DATA_CAD]#(lf)      ,I.[ALIQ_PIS]#(lf)      ,I.[ALIQ_COFINS]#(lf)      ,I.[ID_ITEM_FAB]#(lf)      ,I.[ID_ITEM_COMPRADO]#(lf)      ,I.[PRECO_UL_ENT]#(lf)      ,I.[TIPO_CONTROLE]#(lf)      ,I.[TEMPO_RESSUPRIMENTO]#(lf)      ,I.[FM_CODIGO]#(lf)#(tab)  ,CASE #(lf)        WHEN LEFT(I.[NM_ITEM], 2) IN ('M-', 'EQ') THEN 'Sim'#(lf)        ELSE 'Não'#(lf)    END AS [ContemEQouM]#(lf)  FROM [idba_komatsu].[dbo].[DIM_ITEM_BI] I\"]),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(Fonte, \"Mesclado\", each Text.Combine({[CD_ITEM], \" / \", [NM_ITEM]}), type text),",
        "    #\"Consultas Mescladas1\" = Table.NestedJoin(#\"Coluna Mesclada Inserida\", {\"DIM_ITEM_ID\"}, dItemFornecedor, {\"DIM_ITEM_ID\"}, \"dItemFornecedor\", JoinKind.LeftOuter),",
        "    #\"dItemFornecedor Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas1\", \"dItemFornecedor\", {\"DIM_FORNECEDOR_ID\"}, {\"dItemFornecedor.DIM_FORNECEDOR_ID\"}),",
        "    #\"Colunas Renomeadas2\" = Table.RenameColumns(#\"dItemFornecedor Expandido\",{{\"dItemFornecedor.DIM_FORNECEDOR_ID\", \"DIM_FORNECEDOR_ID\"}}),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Colunas Renomeadas2\",{{\"Mesclado\", \"Cod e Descricao\"}}),",
        "    #\"Consultas Mescladas\" = Table.NestedJoin(#\"Colunas Renomeadas\", {\"COD_C1\"}, dMargemFamilia, {\"Cod.\"}, \"dMargemFamilia\", JoinKind.LeftOuter),",
        "    #\"dMargemFamilia Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"dMargemFamilia\", {\"MG/2022\"}, {\"dMargemFamilia.MG/2022\"}),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"dMargemFamilia Expandido\",{{\"dMargemFamilia.MG/2022\", \"Margem Familia\"}}),",
        "    #\"Texto em Maiúscula\" = Table.TransformColumns(#\"Colunas Renomeadas1\",{{\"CD_ITEM\", Text.Upper, type text}}),",
        "    #\"Texto Aparado\" = Table.TransformColumns(#\"Texto em Maiúscula\",{{\"CD_ITEM\", Text.Trim, type text}}),",
        "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Texto Aparado\", \"CD_ITEM_CONSOLIDADO\", each if Text.End([CD_ITEM],3)=\"-LM\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3)",
        "    else if Text.End([CD_ITEM],1)= \"E\"  then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-1)  ",
        "    else if Text.End([CD_ITEM],1)= \"e\"  then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-1)",
        "    else if Text.End([CD_ITEM],3)=\"-IM\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3) ",
        "    else if Text.End([CD_ITEM],3)=\"-AB\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3) ",
        "    else if Text.End([CD_ITEM],4)=\"-KI-\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-4)",
        "    else if Text.End([CD_ITEM],4)=\"E-KI\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-4)",
        "    else if Text.End([CD_ITEM],3)=\"-KI\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3)",
        "    else if Text.End([CD_ITEM],2)=\"-C\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3)",
        "    else if Text.End([CD_ITEM],1)=\"C\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-1)",
        "    else if Text.End([CD_ITEM],3)=\"E-C\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3)",
        "    else if Text.End([CD_ITEM],4)=\"KI-C\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-4)",
        "    else if Text.End([CD_ITEM],5)=\"-KI-C\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-5)    ",
        "    else if Text.End([CD_ITEM],4)=\"-SUZ\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-4)     ",
        "    else [CD_ITEM]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Personalização Adicionada\",{{\"CD_ITEM_CONSOLIDADO\", type text}}),",
        "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Tipo Alterado\", {\"CD_ITEM\"})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Duplicatas Removidas\",{\"CD_ITEM_CONSOLIDADO\",\"ID_ITEM_COMPRADO\",\"ID_ITEM_FAB\",\"DATA_CAD\",\"DESC_C3\",\"FM_CODIGO\",\"DESC_C2\",\"TEMPO_RESSUPRIMENTO\",\"TIPO_CONTROLE\",\"NM_CD_UM_ITEM\",\"COD_C3\",\"COD_C2\",\"ALIQ_PIS\",\"ALIQ_COFINS\"})",
        "in",
        "    #\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"BRPIN-DBS008\\\\PowerBI\\\", \\\"idba_komatsu\\\", [Query=\\\"SELECT I.[DIM_ITEM_ID]#(lf)      ,I.[CD_ITEM]#(lf)      ,I.[NM_ITEM]#(lf)      ,I.[DESC_C1]#(lf)      ,I.[DESC_C2]#(lf)      ,I.[DESC_C3]#(lf)      ,I.[DESC_C4]#(lf)      ,I.[COD_C1]#(lf)      ,I.[COD_C2]#(lf)      ,I.[COD_C3]#(lf)      ,I.[COD_C4]#(lf)      ,I.[NM_CD_UM_ITEM]#(lf)      ,I.[DATA_CAD]#(lf)      ,I.[ALIQ_PIS]#(lf)      ,I.[ALIQ_COFINS]#(lf)      ,I.[ID_ITEM_FAB]#(lf)      ,I.[ID_ITEM_COMPRADO]#(lf)      ,I.[PRECO_UL_ENT]#(lf)      ,I.[TIPO_CONTROLE]#(lf)      ,I.[TEMPO_RESSUPRIMENTO]#(lf)      ,I.[FM_CODIGO]#(lf)#(tab)  ,CASE #(lf)        WHEN LEFT(I.[NM_ITEM], 2) IN ('M-', 'EQ') THEN 'Sim'#(lf)        ELSE 'Não'#(lf)    END AS [ContemEQouM]#(lf)  FROM [idba_komatsu].[dbo].[DIM_ITEM_BI] I\\\"]),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(Fonte, \\\"Mesclado\\\", each Text.Combine({[CD_ITEM], \\\" / \\\", [NM_ITEM]}), type text),\\r\\n    #\\\"Consultas Mescladas1\\\" = Table.NestedJoin(#\\\"Coluna Mesclada Inserida\\\", {\\\"DIM_ITEM_ID\\\"}, dItemFornecedor, {\\\"DIM_ITEM_ID\\\"}, \\\"dItemFornecedor\\\", JoinKind.LeftOuter),\\r\\n    #\\\"dItemFornecedor Expandido\\\" = Table.ExpandTableColumn(#\\\"Consultas Mescladas1\\\", \\\"dItemFornecedor\\\", {\\\"DIM_FORNECEDOR_ID\\\"}, {\\\"dItemFornecedor.DIM_FORNECEDOR_ID\\\"}),\\r\\n    #\\\"Colunas Renomeadas2\\\" = Table.RenameColumns(#\\\"dItemFornecedor Expandido\\\",{{\\\"dItemFornecedor.DIM_FORNECEDOR_ID\\\", \\\"DIM_FORNECEDOR_ID\\\"}}),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Colunas Renomeadas2\\\",{{\\\"Mesclado\\\", \\\"Cod e Descricao\\\"}}),\\r\\n    #\\\"Consultas Mescladas\\\" = Table.NestedJoin(#\\\"Colunas Renomeadas\\\", {\\\"COD_C1\\\"}, dMargemFamilia, {\\\"Cod.\\\"}, \\\"dMargemFamilia\\\", JoinKind.LeftOuter),\\r\\n    #\\\"dMargemFamilia Expandido\\\" = Table.ExpandTableColumn(#\\\"Consultas Mescladas\\\", \\\"dMargemFamilia\\\", {\\\"MG/2022\\\"}, {\\\"dMargemFamilia.MG/2022\\\"}),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"dMargemFamilia Expandido\\\",{{\\\"dMargemFamilia.MG/2022\\\", \\\"Margem Familia\\\"}}),\\r\\n    #\\\"Texto em Maiúscula\\\" = Table.TransformColumns(#\\\"Colunas Renomeadas1\\\",{{\\\"CD_ITEM\\\", Text.Upper, type text}}),\\r\\n    #\\\"Texto Aparado\\\" = Table.TransformColumns(#\\\"Texto em Maiúscula\\\",{{\\\"CD_ITEM\\\", Text.Trim, type text}}),\\r\\n    #\\\"Personalização Adicionada\\\" = Table.AddColumn(#\\\"Texto Aparado\\\", \\\"CD_ITEM_CONSOLIDADO\\\", each if Text.End([CD_ITEM],3)=\\\"-LM\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3)\\r\\n    else if Text.End([CD_ITEM],1)= \\\"E\\\"  then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-1)  \\r\\n    else if Text.End([CD_ITEM],1)= \\\"e\\\"  then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-1)\\r\\n    else if Text.End([CD_ITEM],3)=\\\"-IM\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3) \\r\\n    else if Text.End([CD_ITEM],3)=\\\"-AB\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3) \\r\\n    else if Text.End([CD_ITEM],4)=\\\"-KI-\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-4)\\r\\n    else if Text.End([CD_ITEM],4)=\\\"E-KI\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-4)\\r\\n    else if Text.End([CD_ITEM],3)=\\\"-KI\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3)\\r\\n    else if Text.End([CD_ITEM],2)=\\\"-C\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3)\\r\\n    else if Text.End([CD_ITEM],1)=\\\"C\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-1)\\r\\n    else if Text.End([CD_ITEM],3)=\\\"E-C\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-3)\\r\\n    else if Text.End([CD_ITEM],4)=\\\"KI-C\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-4)\\r\\n    else if Text.End([CD_ITEM],5)=\\\"-KI-C\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-5)    \\r\\n    else if Text.End([CD_ITEM],4)=\\\"-SUZ\\\" then Text.Start([CD_ITEM],Text.Length([CD_ITEM])-4)     \\r\\n    else [CD_ITEM]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada\\\",{{\\\"CD_ITEM_CONSOLIDADO\\\", type text}}),\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(#\\\"Tipo Alterado\\\", {\\\"CD_ITEM\\\"})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Duplicatas Removidas\\\",{\\\"CD_ITEM_CONSOLIDADO\\\",\\\"ID_ITEM_COMPRADO\\\",\\\"ID_ITEM_FAB\\\",\\\"DATA_CAD\\\",\\\"DESC_C3\\\",\\\"FM_CODIGO\\\",\\\"DESC_C2\\\",\\\"TEMPO_RESSUPRIMENTO\\\",\\\"TIPO_CONTROLE\\\",\\\"NM_CD_UM_ITEM\\\",\\\"COD_C3\\\",\\\"COD_C2\\\",\\\"ALIQ_PIS\\\",\\\"ALIQ_COFINS\\\"})\\r\\nin\\r\\n    #\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dDivisaoVendas",
      "lineageTag": "85d3a66b-954c-4d7b-a2fd-530c3e45bc3a",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "        Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_DIVISAO_VENDA_BI= Fonte{[Schema=\"dbo\",Item=\"DIM_DIVISAO_VENDA_BI\"]}[Data],",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(dbo_DIM_DIVISAO_VENDA_BI, \"Cod Descr Div\", each Text.Combine({[COD_DIVISAO_VENDA], [DESC_DIVISAO_VENDA]}, \" - \"), type text)",
        "in",
        "    #\"Coluna Mesclada Inserida\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n        Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_DIVISAO_VENDA_BI= Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_DIVISAO_VENDA_BI\\\"]}[Data],\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(dbo_DIM_DIVISAO_VENDA_BI, \\\"Cod Descr Div\\\", each Text.Combine({[COD_DIVISAO_VENDA], [DESC_DIVISAO_VENDA]}, \\\" - \\\"), type text)\\r\\nin\\r\\n    #\\\"Coluna Mesclada Inserida\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "dEmpresa",
      "lineageTag": "65afbc5c-b7b5-47d4-bf20-ec7588a0bf0c",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_EMPRESA_BI = Fonte{[Schema=\"dbo\",Item=\"DIM_EMPRESA_BI\"]}[Data],",
        "    #\"Linhas Filtradas\" = Table.SelectRows(dbo_DIM_EMPRESA_BI, each [DIM_EMPRESA_ID] <> 104 and [DIM_EMPRESA_ID] <> 107 and [DIM_EMPRESA_ID] <> 108),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Linhas Filtradas\",{\"column6\"}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Colunas Removidas\", \"Estabelecimento\", each Text.Combine({Text.From([COD_EMPRESA], \"en-US\"), [CIDADE]}, \" - \"), type text),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Coluna Mesclada Inserida\",{{\"DIM_EMPRESA_ID\", type text}, {\"COD_EMPRESA\", type text}}),",
        "    #\"Columns removed by Measure Killer\" = Table.RemoveColumns(#\"Tipo Alterado\",{\"CNPJ\",\"CIDADE\",\"DESC_EMPRESA\",\"NOME_FANTASIA\"}),",
        "    // Inserindo a nova linha ao final da tabela",
        "    #\"Linha Adicionada\" = Table.InsertRows(",
        "        #\"Columns removed by Measure Killer\", ",
        "        Table.RowCount(#\"Columns removed by Measure Killer\"),",
        "        {",
        "            [",
        "                DIM_EMPRESA_ID = \"INTERCOMPANY\", ",
        "                COD_EMPRESA = \"INTERCOMPANY\", ",
        "                REGIONAL = \"INTERCOMPANY\",",
        "                DIM_EMITENTE_ESTAB = 999,",
        "                Estabelecimento = \"999 - INTERCOMPANY\"",
        "            ]",
        "        }",
        "    )",
        "in",
        "    #\"Linha Adicionada\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_EMPRESA_BI = Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_EMPRESA_BI\\\"]}[Data],\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(dbo_DIM_EMPRESA_BI, each [DIM_EMPRESA_ID] <> 104 and [DIM_EMPRESA_ID] <> 107 and [DIM_EMPRESA_ID] <> 108),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Linhas Filtradas\\\",{\\\"column6\\\"}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Colunas Removidas\\\", \\\"Estabelecimento\\\", each Text.Combine({Text.From([COD_EMPRESA], \\\"en-US\\\"), [CIDADE]}, \\\" - \\\"), type text),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Coluna Mesclada Inserida\\\",{{\\\"DIM_EMPRESA_ID\\\", type text}, {\\\"COD_EMPRESA\\\", type text}}),\\r\\n    #\\\"Columns removed by Measure Killer\\\" = Table.RemoveColumns(#\\\"Tipo Alterado\\\",{\\\"CNPJ\\\",\\\"CIDADE\\\",\\\"DESC_EMPRESA\\\",\\\"NOME_FANTASIA\\\"}),\\r\\n    // Inserindo a nova linha ao final da tabela\\r\\n    #\\\"Linha Adicionada\\\" = Table.InsertRows(\\r\\n        #\\\"Columns removed by Measure Killer\\\", \\r\\n        Table.RowCount(#\\\"Columns removed by Measure Killer\\\"),\\r\\n        {\\r\\n            [\\r\\n                DIM_EMPRESA_ID = \\\"INTERCOMPANY\\\", \\r\\n                COD_EMPRESA = \\\"INTERCOMPANY\\\", \\r\\n                REGIONAL = \\\"INTERCOMPANY\\\",\\r\\n                DIM_EMITENTE_ESTAB = 999,\\r\\n                Estabelecimento = \\\"999 - INTERCOMPANY\\\"\\r\\n            ]\\r\\n        }\\r\\n    )\\r\\nin\\r\\n    #\\\"Linha Adicionada\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dCondicaoPagamento",
      "lineageTag": "ca1ecd1d-2f6d-4fec-aa44-e81754fad449",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "        Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_COND_PAGTO_BI = Fonte{[Schema=\"dbo\",Item=\"DIM_COND_PAGTO_BI\"]}[Data]",
        "     ",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(   dbo_DIM_COND_PAGTO_BI,{\"DESC_PGTO\",\"COD_COND_PGTO\",\"QTDE_PARC\",\"PRAZO_MEDIO\",\"column6\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n        Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_COND_PAGTO_BI = Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_COND_PAGTO_BI\\\"]}[Data]\\r\\n     \\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(   dbo_DIM_COND_PAGTO_BI,{\\\"DESC_PGTO\\\",\\\"COD_COND_PGTO\\\",\\\"QTDE_PARC\\\",\\\"PRAZO_MEDIO\\\",\\\"column6\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dLocal",
      "lineageTag": "5f26f7f5-4c9c-44e3-990e-25556599086e",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_LOCAL_BI= Fonte{[Schema=\"dbo\",Item=\"DIM_LOCAL_BI\"]}[Data] ",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(   dbo_DIM_LOCAL_BI,{\"NOME_UF\",\"SIGLA_PAIS\",\"LONGITUDE\",\"LATITUDE\",\"column10\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_LOCAL_BI= Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_LOCAL_BI\\\"]}[Data] \\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(   dbo_DIM_LOCAL_BI,{\\\"NOME_UF\\\",\\\"SIGLA_PAIS\\\",\\\"LONGITUDE\\\",\\\"LATITUDE\\\",\\\"column10\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dRepresentante",
      "lineageTag": "c2926df9-4514-48ea-97b1-66c2505132e8",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_REPRESENTANTE_BI= Fonte{[Schema=\"dbo\",Item=\"DIM_REPRESENTANTE_BI\"]}[Data],",
        "    #\"Coluna Condicional Adicionada\" = Table.AddColumn(dbo_DIM_REPRESENTANTE_BI, \"Personalizar\", each if [REPRESENTANTE] = \"JEFFERSON DE SOUZA MARCAL\" then 115 else if [REPRESENTANTE] = \"BRENO SOUZA VIANA\" then 999 else if [REPRESENTANTE] = \"GENILDO VIEIRA DA SILVA\" then 999 else if [REPRESENTANTE] = \"BRUNO DIAS DOS REIS\" then 123 else if [COD_REPRESENTANTE] = \"5\" then 113 else if [COD_REPRESENTANTE] = \"46\" then 115 else null),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Condicional Adicionada\",{{\"Personalizar\", \"Estabelecimento\"}}),",
        "    #\"Coluna Personalizada Adicionada\" = Table.AddColumn(#\"Colunas Renomeadas\", \"Personalizar\", each let splitREPRESENTANTE = Splitter.SplitTextByDelimiter(\" \", QuoteStyle.None)([REPRESENTANTE]), splitREPRESENTANTE2 = List.Reverse(Splitter.SplitTextByDelimiter(\" \", QuoteStyle.None)([REPRESENTANTE])) in Text.Combine({splitREPRESENTANTE{0}?, \" \", splitREPRESENTANTE2{0}?}), type text),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"Coluna Personalizada Adicionada\",{{\"Personalizar\", \"NOME\"}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Colunas Renomeadas1\",{\"SUPERIOR\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_REPRESENTANTE_BI= Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_REPRESENTANTE_BI\\\"]}[Data],\\r\\n    #\\\"Coluna Condicional Adicionada\\\" = Table.AddColumn(dbo_DIM_REPRESENTANTE_BI, \\\"Personalizar\\\", each if [REPRESENTANTE] = \\\"JEFFERSON DE SOUZA MARCAL\\\" then 115 else if [REPRESENTANTE] = \\\"BRENO SOUZA VIANA\\\" then 999 else if [REPRESENTANTE] = \\\"GENILDO VIEIRA DA SILVA\\\" then 999 else if [REPRESENTANTE] = \\\"BRUNO DIAS DOS REIS\\\" then 123 else if [COD_REPRESENTANTE] = \\\"5\\\" then 113 else if [COD_REPRESENTANTE] = \\\"46\\\" then 115 else null),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Coluna Condicional Adicionada\\\",{{\\\"Personalizar\\\", \\\"Estabelecimento\\\"}}),\\r\\n    #\\\"Coluna Personalizada Adicionada\\\" = Table.AddColumn(#\\\"Colunas Renomeadas\\\", \\\"Personalizar\\\", each let splitREPRESENTANTE = Splitter.SplitTextByDelimiter(\\\" \\\", QuoteStyle.None)([REPRESENTANTE]), splitREPRESENTANTE2 = List.Reverse(Splitter.SplitTextByDelimiter(\\\" \\\", QuoteStyle.None)([REPRESENTANTE])) in Text.Combine({splitREPRESENTANTE{0}?, \\\" \\\", splitREPRESENTANTE2{0}?}), type text),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"Coluna Personalizada Adicionada\\\",{{\\\"Personalizar\\\", \\\"NOME\\\"}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Colunas Renomeadas1\\\",{\\\"SUPERIOR\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dCalendario",
      "lineageTag": "31ec10c3-71d3-4390-92e4-0f73ca3417e7",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "        Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_TEMPO_BI = Fonte{[Schema=\"dbo\",Item=\"DIM_TEMPO_BI\"]}[Data],",
        "     #\"Coluna Duplicada\" = Table.DuplicateColumn(dbo_DIM_TEMPO_BI, \"DT_DATA\", \"DT_DATA - Copiar\"),",
        "    #\"Nome do Mês Extraído\" = Table.TransformColumns(#\"Coluna Duplicada\", {{\"DT_DATA - Copiar\", each Date.MonthName(_), type text}}),",
        "    #\"Texto em Maiúscula\" = Table.TransformColumns(#\"Nome do Mês Extraído\",{{\"DT_DATA - Copiar\", Text.Upper, type text}}),",
        "    #\"Primeiros caracteres extraídos\" = Table.TransformColumns(#\"Texto em Maiúscula\", {{\"DT_DATA - Copiar\", each Text.Start(_, 3), type text}}),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Primeiros caracteres extraídos\",{{\"DT_DATA - Copiar\", \"MES TEXT\"}}),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Colunas Renomeadas\",{{\"DT_DATA\", type date}, {\"MES\", Int64.Type}, {\"DIA\", Int64.Type}, {\"ANO\", Int64.Type}, {\"SEMANA\", Int64.Type}, {\"BIMESTRE\", Int64.Type}, {\"TRIMESTRE\", Int64.Type}, {\"SEMESTRE\", Int64.Type}, {\"DIA_UTIL\", Int64.Type}, {\"DIAS_UTEIS_MES\", Int64.Type}}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Tipo Alterado\", \"MES - ANO\", each Text.Combine({[MES TEXT], Text.From([ANO], \"en-US\")}, \" / \"), type text),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Coluna Mesclada Inserida\",{\"column11\"}),",
        "    #\"Added Conditional Column\" = Table.AddColumn(#\"Colunas Removidas\", \"Text Month\", each if [MES] = 1 then \"Jan\" else if [MES] = 2 then \"Feb\" else if [MES] = 3 then \"Mar\" else if [MES] = 4 then \"Apr\" else if [MES] = 5 then \"May\" else if [MES] = 6 then \"Jun\" else if [MES] = 7 then \"Jul\" else if [MES] = 8 then \"Aug\" else if [MES] = 9 then \"Sep\" else if [MES] = 10 then \"Oct\" else if [MES] = 11 then \"Nov\" else if [MES] = 12 then \"Dec\" else null, type text),",
        "    #\"Added Custom\" = Table.AddColumn(#\"Added Conditional Column\", \"Month/Year\", ",
        "each Text.Combine({",
        "Text.From([Text Month],\"pt-BR\"),",
        "(\" / \"),",
        "Text.From([ANO],\"pt-BR\")",
        "}),type text)",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Added Custom\",{\"DIM_PERIODO_ID\",\"MES - ANO\",\"BIMESTRE\",\"DIAS_UTEIS_MES\",\"SEMESTRE\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n        Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_TEMPO_BI = Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_TEMPO_BI\\\"]}[Data],\\r\\n     #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(dbo_DIM_TEMPO_BI, \\\"DT_DATA\\\", \\\"DT_DATA - Copiar\\\"),\\r\\n    #\\\"Nome do Mês Extraído\\\" = Table.TransformColumns(#\\\"Coluna Duplicada\\\", {{\\\"DT_DATA - Copiar\\\", each Date.MonthName(_), type text}}),\\r\\n    #\\\"Texto em Maiúscula\\\" = Table.TransformColumns(#\\\"Nome do Mês Extraído\\\",{{\\\"DT_DATA - Copiar\\\", Text.Upper, type text}}),\\r\\n    #\\\"Primeiros caracteres extraídos\\\" = Table.TransformColumns(#\\\"Texto em Maiúscula\\\", {{\\\"DT_DATA - Copiar\\\", each Text.Start(_, 3), type text}}),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Primeiros caracteres extraídos\\\",{{\\\"DT_DATA - Copiar\\\", \\\"MES TEXT\\\"}}),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Colunas Renomeadas\\\",{{\\\"DT_DATA\\\", type date}, {\\\"MES\\\", Int64.Type}, {\\\"DIA\\\", Int64.Type}, {\\\"ANO\\\", Int64.Type}, {\\\"SEMANA\\\", Int64.Type}, {\\\"BIMESTRE\\\", Int64.Type}, {\\\"TRIMESTRE\\\", Int64.Type}, {\\\"SEMESTRE\\\", Int64.Type}, {\\\"DIA_UTIL\\\", Int64.Type}, {\\\"DIAS_UTEIS_MES\\\", Int64.Type}}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Tipo Alterado\\\", \\\"MES - ANO\\\", each Text.Combine({[MES TEXT], Text.From([ANO], \\\"en-US\\\")}, \\\" / \\\"), type text),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Coluna Mesclada Inserida\\\",{\\\"column11\\\"}),\\r\\n    #\\\"Added Conditional Column\\\" = Table.AddColumn(#\\\"Colunas Removidas\\\", \\\"Text Month\\\", each if [MES] = 1 then \\\"Jan\\\" else if [MES] = 2 then \\\"Feb\\\" else if [MES] = 3 then \\\"Mar\\\" else if [MES] = 4 then \\\"Apr\\\" else if [MES] = 5 then \\\"May\\\" else if [MES] = 6 then \\\"Jun\\\" else if [MES] = 7 then \\\"Jul\\\" else if [MES] = 8 then \\\"Aug\\\" else if [MES] = 9 then \\\"Sep\\\" else if [MES] = 10 then \\\"Oct\\\" else if [MES] = 11 then \\\"Nov\\\" else if [MES] = 12 then \\\"Dec\\\" else null, type text),\\r\\n    #\\\"Added Custom\\\" = Table.AddColumn(#\\\"Added Conditional Column\\\", \\\"Month/Year\\\", \\r\\neach Text.Combine({\\r\\nText.From([Text Month],\\\"pt-BR\\\"),\\r\\n(\\\" / \\\"),\\r\\nText.From([ANO],\\\"pt-BR\\\")\\r\\n}),type text)\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Added Custom\\\",{\\\"DIM_PERIODO_ID\\\",\\\"MES - ANO\\\",\\\"BIMESTRE\\\",\\\"DIAS_UTEIS_MES\\\",\\\"SEMESTRE\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dTipoNota",
      "lineageTag": "7ab80f2b-5bb3-4115-8b2b-1b37c3d04335",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_TIPO_NOTA_BI =  Fonte{[Schema=\"dbo\",Item=\"DIM_TIPO_NOTA_BI\"]}[Data]",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    dbo_DIM_TIPO_NOTA_BI,{\"DESC_TIPO_NOTA\",\"BAIXA_ESTOQ\",\"RECEITA\",\"EMITE_DUPLIC\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_TIPO_NOTA_BI =  Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_TIPO_NOTA_BI\\\"]}[Data]\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    dbo_DIM_TIPO_NOTA_BI,{\\\"DESC_TIPO_NOTA\\\",\\\"BAIXA_ESTOQ\\\",\\\"RECEITA\\\",\\\"EMITE_DUPLIC\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dTransportadora",
      "lineageTag": "9435dee5-98e5-41c6-b96c-8592e6a6c1ff",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_TRANSPORTADORA_BI = Fonte{[Schema=\"dbo\",Item=\"DIM_TRANSPORTADORA_BI\"]}[Data],",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(dbo_DIM_TRANSPORTADORA_BI,{\"DT_CADASTRO\", \"column6\"})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Colunas Removidas\",{\"TRANSPORTADORA\",\"COD_TRANSPORTADORA\",\"CNPJ\",\"ATIVO\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_TRANSPORTADORA_BI = Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_TRANSPORTADORA_BI\\\"]}[Data],\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(dbo_DIM_TRANSPORTADORA_BI,{\\\"DT_CADASTRO\\\", \\\"column6\\\"})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Colunas Removidas\\\",{\\\"TRANSPORTADORA\\\",\\\"COD_TRANSPORTADORA\\\",\\\"CNPJ\\\",\\\"ATIVO\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dMunicipio",
      "lineageTag": "b74897d2-cb37-4d16-9211-c30a6686838a",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    //Atualizado 24.Out para pegar direto do sharepoint",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Municipios xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Municipios.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"Municipios xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\"),",
        "    DTB_2018_Municipio_Sheet1 = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"DTB_2018_Municipio\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(DTB_2018_Municipio_Sheet1, [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"DDD UF\", Int64.Type}, {\"UF\", type text}, {\"Nome_UF\", type text}, {\"Município\", Int64.Type}, {\"Código Município Completo\", Int64.Type}, {\"Nome_Município\", type text}, {\"Região\", type text}, {\"Localização\", type text}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Tipo Alterado\",{\"Nome_Município\",\"Código Município Completo\",\"Município\",\"UF\",\"DDD UF\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    //Atualizado 24.Out para pegar direto do sharepoint\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Municipios xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Municipios.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"Municipios xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\"),\\r\\n    DTB_2018_Municipio_Sheet1 = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"DTB_2018_Municipio\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(DTB_2018_Municipio_Sheet1, [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"DDD UF\\\", Int64.Type}, {\\\"UF\\\", type text}, {\\\"Nome_UF\\\", type text}, {\\\"Município\\\", Int64.Type}, {\\\"Código Município Completo\\\", Int64.Type}, {\\\"Nome_Município\\\", type text}, {\\\"Região\\\", type text}, {\\\"Localização\\\", type text}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Tipo Alterado\\\",{\\\"Nome_Município\\\",\\\"Código Município Completo\\\",\\\"Município\\\",\\\"UF\\\",\\\"DDD UF\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dUltimaAtualizacao",
      "lineageTag": "207bc1c2-e696-431c-ae70-a5b187bdde0e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\", [Query=\"select max(data_hora) as data_hora from log_atualizacao\"])",
        "in",
        "    Fonte"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\", [Query=\\\"select max(data_hora) as data_hora from log_atualizacao\\\"])\\r\\nin\\r\\n    Fonte\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dUnidadeDeNegocio",
      "lineageTag": "1d0393d0-3cf9-4805-ac90-d4c14ab6b2af",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "     Fonte = Sql.Databases(\"10.105.40.196\\powerbi\"),",
        "    idba_komatsu = Fonte{[Name=\"idba_komatsu\"]}[Data],",
        "    dbo_DIM_PORTADOR_BI= idba_komatsu{[Schema=\"dbo\",Item=\"DIM_UNID_NEGOC_BI\"]}[Data],",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(dbo_DIM_PORTADOR_BI,{\"column3\"}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Colunas Removidas\", \"Unid. Negocio\", each Text.Combine({[COD_UNID_NEGOC], [NM_UNID_NEGOC]}, \" - \"), type text)",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Coluna Mesclada Inserida\",{\"NM_UNID_NEGOC\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n     Fonte = Sql.Databases(\\\"10.105.40.196\\\\powerbi\\\"),\\r\\n    idba_komatsu = Fonte{[Name=\\\"idba_komatsu\\\"]}[Data],\\r\\n    dbo_DIM_PORTADOR_BI= idba_komatsu{[Schema=\\\"dbo\\\",Item=\\\"DIM_UNID_NEGOC_BI\\\"]}[Data],\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(dbo_DIM_PORTADOR_BI,{\\\"column3\\\"}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Colunas Removidas\\\", \\\"Unid. Negocio\\\", each Text.Combine({[COD_UNID_NEGOC], [NM_UNID_NEGOC]}, \\\" - \\\"), type text)\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Coluna Mesclada Inserida\\\",{\\\"NM_UNID_NEGOC\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dModeloItem",
      "lineageTag": "468ae364-1c27-4ac3-93be-a3914a583364",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_ITEM_MODELO = Fonte{[Schema=\"dbo\",Item=\"DIM_ITEM_MODELO\"]}[Data],",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(dbo_DIM_ITEM_MODELO, \"Mesclado\", each Text.Combine({\"0\", [GE_CODIGO]}), type text),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Mesclada Inserida\",{{\"Mesclado\", \"GE\"}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Colunas Renomeadas\",{\"GE_CODIGO\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_ITEM_MODELO = Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_ITEM_MODELO\\\"]}[Data],\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(dbo_DIM_ITEM_MODELO, \\\"Mesclado\\\", each Text.Combine({\\\"0\\\", [GE_CODIGO]}), type text),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida\\\",{{\\\"Mesclado\\\", \\\"GE\\\"}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Colunas Renomeadas\\\",{\\\"GE_CODIGO\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dItemFornecedor",
      "lineageTag": "c5374b7e-8276-4b27-b2c4-b4740bc9ae5c",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_ITEM_FORNECEDOR = Fonte{[Schema=\"dbo\",Item=\"DIM_ITEM_FORNECEDOR\"]}[Data],",
        "    #\"Linhas Filtradas\" = Table.SelectRows(dbo_DIM_ITEM_FORNECEDOR, each [DIM_ITEM_ID] <> null and [DIM_ITEM_ID] <> \"\"),",
        "    #\"Consultas Mescladas\" = Table.NestedJoin(#\"Linhas Filtradas\", {\"DIM_FORNECEDOR_ID\"}, dFornecedor, {\"DIM_FORNECEDOR_ID\"}, \"dFornecedor\", JoinKind.LeftOuter),",
        "    #\"dFornecedor Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"dFornecedor\", {\"DESCRICAO\"}, {\"dFornecedor.DESCRICAO\"}),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"dFornecedor Expandido\",{{\"dFornecedor.DESCRICAO\", \"FORNECEDOR\"}})",
        "in",
        "    #\"Colunas Renomeadas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_ITEM_FORNECEDOR = Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_ITEM_FORNECEDOR\\\"]}[Data],\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(dbo_DIM_ITEM_FORNECEDOR, each [DIM_ITEM_ID] <> null and [DIM_ITEM_ID] <> \\\"\\\"),\\r\\n    #\\\"Consultas Mescladas\\\" = Table.NestedJoin(#\\\"Linhas Filtradas\\\", {\\\"DIM_FORNECEDOR_ID\\\"}, dFornecedor, {\\\"DIM_FORNECEDOR_ID\\\"}, \\\"dFornecedor\\\", JoinKind.LeftOuter),\\r\\n    #\\\"dFornecedor Expandido\\\" = Table.ExpandTableColumn(#\\\"Consultas Mescladas\\\", \\\"dFornecedor\\\", {\\\"DESCRICAO\\\"}, {\\\"dFornecedor.DESCRICAO\\\"}),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"dFornecedor Expandido\\\",{{\\\"dFornecedor.DESCRICAO\\\", \\\"FORNECEDOR\\\"}})\\r\\nin\\r\\n    #\\\"Colunas Renomeadas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dTabelaPreco",
      "lineageTag": "a2fd5b92-e7b2-42db-83d2-dd3ecf5ed249",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Databases(\"BRPIN-DBS008\\PowerBI\"),",
        "    idba_komatsu = Fonte{[Name=\"idba_komatsu\"]}[Data],",
        "    dbo_DIM_ITEM_TAB_PRECO = idba_komatsu{[Schema=\"dbo\",Item=\"DIM_ITEM_TAB_PRECO\"]}[Data],",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(dbo_DIM_ITEM_TAB_PRECO,{{\"DATA_INICIO\", type date}, {\"DATA_FIM\", type date}}),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Tipo Alterado\",{\"DIM_TAB_ID\"})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Colunas Removidas\",{\"NOME_TABELA\",\"TABELA\",\"SITUACAO\",\"DATA_INICIO\",\"DATA_FIM\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Databases(\\\"BRPIN-DBS008\\\\PowerBI\\\"),\\r\\n    idba_komatsu = Fonte{[Name=\\\"idba_komatsu\\\"]}[Data],\\r\\n    dbo_DIM_ITEM_TAB_PRECO = idba_komatsu{[Schema=\\\"dbo\\\",Item=\\\"DIM_ITEM_TAB_PRECO\\\"]}[Data],\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(dbo_DIM_ITEM_TAB_PRECO,{{\\\"DATA_INICIO\\\", type date}, {\\\"DATA_FIM\\\", type date}}),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Tipo Alterado\\\",{\\\"DIM_TAB_ID\\\"})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Colunas Removidas\\\",{\\\"NOME_TABELA\\\",\\\"TABELA\\\",\\\"SITUACAO\\\",\\\"DATA_INICIO\\\",\\\"DATA_FIM\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dFornecedor",
      "lineageTag": "30d6e3b9-44de-4883-9974-9d1f3195f90c",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_DIM_FORNECEDOR_BI = Fonte{[Schema=\"dbo\",Item=\"DIM_FORNECEDOR_BI\"]}[Data]",
        "in",
        "    dbo_DIM_FORNECEDOR_BI"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_DIM_FORNECEDOR_BI = Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_FORNECEDOR_BI\\\"]}[Data]\\r\\nin\\r\\n    dbo_DIM_FORNECEDOR_BI\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dClienteModulo",
      "lineageTag": "12df393f-7d01-4377-bc1a-b6ca7f431e1a",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "//Mudamos fonte no dia 2.10.2023 para pegar direto do sharepoint e não mais do arquivo local",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Clientes-Modulos csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Clientes-Modulos.csv\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"CSV Importado\" = Csv.Document(#\"Clientes-Modulos csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\",[Delimiter=\";\", Columns=3, Encoding=1252, QuoteStyle=QuoteStyle.None]),",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(#\"CSV Importado\", [PromoteAllScalars=true])",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Cabeçalhos Promovidos\",{\"NOME\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n//Mudamos fonte no dia 2.10.2023 para pegar direto do sharepoint e não mais do arquivo local\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Clientes-Modulos csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Clientes-Modulos.csv\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"CSV Importado\\\" = Csv.Document(#\\\"Clientes-Modulos csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\",[Delimiter=\\\";\\\", Columns=3, Encoding=1252, QuoteStyle=QuoteStyle.None]),\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(#\\\"CSV Importado\\\", [PromoteAllScalars=true])\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Cabeçalhos Promovidos\\\",{\\\"NOME\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fRecebimento",
      "lineageTag": "abb35c42-ddb0-42b6-ac5d-925faaaec06b",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\", [Query=\"SELECT [DIM_EMPRESA_ID]#(lf)      ,[SERIE_DOCTO]#(lf)      ,[NRO_DOCTO]#(lf)      ,[DIM_FORNECEDOR_ID]#(lf)      ,[DT_TRANS]#(lf)      ,[DT_EMISSAO]#(lf)      ,[DT_ATUALIZA]#(lf)      ,[DT_ENTR_MERC]#(lf)      ,[HR_ATUALIZA]#(lf)      ,[ESP_DOCTO]#(lf)      ,[TIPO_OPERAC]#(lf)      ,[TIPO_NOTA]#(lf)      ,[TIPO_DOCTO]#(lf)      ,[NF_ELETRO]#(lf)      ,[SIT_DOCUM]#(lf)      ,[SIT_ATUAL]#(lf)      ,[NRO_PROC_ENT]#(lf)      ,[NRO_PROC_SAI]#(lf)      ,[REC_FISICO]#(lf)      ,[USUARIO]#(lf)      ,[COTACAO_DIA]#(lf)      ,[ATUALIZA_CR]#(lf)      ,[CE_ATUAL]#(lf)      ,[CP_ATUAL]#(lf)      ,[CR_ATUAL]#(lf)      ,[DIM_ITEM_ID]#(lf)      ,[PROC_IMP]#(lf)      ,[OP_CODIGO]#(lf)      ,[ORIGEM]#(lf)      ,[NUMERO_ORDEM]#(lf)      ,[PARCELA]#(lf)      ,[QUANTIDADE]#(lf)      ,[QT_SALDO]#(lf)      ,[QT_FORNE]#(lf)      ,[PRECO_TOTAL]#(lf)      ,[PR_TOTAL]#(lf)      ,[VALOR_ICM]#(lf)  FROM [idba_komatsu].[dbo].[FATO_RECEBIMENTO_BI]#(lf)  WHERE DT_EMISSAO > '2021-01-01 00:00:00.000'#(lf)  AND   ESP_DOCTO = 21#(lf)  AND   NUMERO_ORDEM <> 0\"])",
        "in",
        "    Fonte"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\", [Query=\\\"SELECT [DIM_EMPRESA_ID]#(lf)      ,[SERIE_DOCTO]#(lf)      ,[NRO_DOCTO]#(lf)      ,[DIM_FORNECEDOR_ID]#(lf)      ,[DT_TRANS]#(lf)      ,[DT_EMISSAO]#(lf)      ,[DT_ATUALIZA]#(lf)      ,[DT_ENTR_MERC]#(lf)      ,[HR_ATUALIZA]#(lf)      ,[ESP_DOCTO]#(lf)      ,[TIPO_OPERAC]#(lf)      ,[TIPO_NOTA]#(lf)      ,[TIPO_DOCTO]#(lf)      ,[NF_ELETRO]#(lf)      ,[SIT_DOCUM]#(lf)      ,[SIT_ATUAL]#(lf)      ,[NRO_PROC_ENT]#(lf)      ,[NRO_PROC_SAI]#(lf)      ,[REC_FISICO]#(lf)      ,[USUARIO]#(lf)      ,[COTACAO_DIA]#(lf)      ,[ATUALIZA_CR]#(lf)      ,[CE_ATUAL]#(lf)      ,[CP_ATUAL]#(lf)      ,[CR_ATUAL]#(lf)      ,[DIM_ITEM_ID]#(lf)      ,[PROC_IMP]#(lf)      ,[OP_CODIGO]#(lf)      ,[ORIGEM]#(lf)      ,[NUMERO_ORDEM]#(lf)      ,[PARCELA]#(lf)      ,[QUANTIDADE]#(lf)      ,[QT_SALDO]#(lf)      ,[QT_FORNE]#(lf)      ,[PRECO_TOTAL]#(lf)      ,[PR_TOTAL]#(lf)      ,[VALOR_ICM]#(lf)  FROM [idba_komatsu].[dbo].[FATO_RECEBIMENTO_BI]#(lf)  WHERE DT_EMISSAO > '2021-01-01 00:00:00.000'#(lf)  AND   ESP_DOCTO = 21#(lf)  AND   NUMERO_ORDEM <> 0\\\"])\\r\\nin\\r\\n    Fonte\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fPedido",
      "lineageTag": "bc7b9118-4216-42eb-a508-834aa929a4ee",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    //Incluimos valor da cotação para usar na aba machines Backlog",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\", [Query=\"SELECT A.*, B.DESCRICAO_MOEDA, B.VALOR_COTAC#(lf)FROM [idba_komatsu].[dbo].[FATO_PEDIDO_BI] A#(lf)LEFT JOIN (SELECT A.MOEDA, A.DESCRICAO_MOEDA ,A.VALOR_COTAC FROM idba_komatsu.dbo.DIM_MOEDA_COTACAO A WHERE CONVERT(DATE, DATA_COTAC) = CONVERT(DATE, GETDATE() - 1)) B ON B.MOEDA = A.\"\"mo-codigo\"\"\"]),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(Fonte,{{\"NF_DATA\", type date}}),",
        "    #\"Inserted Merged Column\" = Table.AddColumn(#\"Changed Type\", \"Merged\", each Text.Combine({[DIM_EMPRESA_ID], [DIM_ITEM_ID]}), type text),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Inserted Merged Column\",{{\"Merged\", \"ID Estab\"}}),",
        "    #\"Consultas Mescladas\" = Table.NestedJoin(#\"Colunas Renomeadas\", {\"DIM_DIVISAO_VENDA_ID\"}, dDivisaoVendas, {\"DIM_DIVISAO_VENDA_ID\"}, \"DIVISAO VENDA\", JoinKind.LeftOuter),",
        "    #\"DIVISAO VENDA Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"DIVISAO VENDA\", {\"TP_DIVISAO_VENDA\", \"DESC_AGRUP_DIVISAO_VENDA\"}, {\"DIVISAO VENDA.TP_DIVISAO_VENDA\", \"DIVISAO VENDA.DESC_AGRUP_DIVISAO_VENDA\"}),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"DIVISAO VENDA Expandido\",{{\"DIVISAO VENDA.TP_DIVISAO_VENDA\", \"TIPO DIVISAO\"}, {\"DIVISAO VENDA.DESC_AGRUP_DIVISAO_VENDA\", \"EMPRESA\"}}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Colunas Renomeadas1\", \"ID_PEDIDO\", each Text.Combine({[NR_PEDIDO], Text.From([NR_SEQ_PED], \"pt-BR\")}, \"\"), type text),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Coluna Mesclada Inserida\",{{\"NR_SEQ_PED\", type text}}),",
        "    //Esta personalização busca adicionar uma coluna que irá vincular com a tabela fPedidosItemMaq para levar o DT_ENTREGA e POS_PDV",
        "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Tipo Alterado1\", \"chave\", each [NR_PEDIDO] & [NR_SEQ_PED]),",
        "    //Esta nova coluna servira como chave no relacionamento com a tabela dItemDemandType",
        "    #\"Personalização Adicionada1\" = Table.AddColumn(#\"Personalização Adicionada\", \"ID_CodEmpresa_ItemCode\", each [DIM_EMPRESA_ID] & [DIM_ITEM_ID]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Personalização Adicionada1\",{{\"chave\", type text}, {\"ID_CodEmpresa_ItemCode\", type text}, {\"DT_CANCELA_ITEM\", type date}})",
        "in",
        "    #\"Tipo Alterado\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    //Incluimos valor da cotação para usar na aba machines Backlog\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\", [Query=\\\"SELECT A.*, B.DESCRICAO_MOEDA, B.VALOR_COTAC#(lf)FROM [idba_komatsu].[dbo].[FATO_PEDIDO_BI] A#(lf)LEFT JOIN (SELECT A.MOEDA, A.DESCRICAO_MOEDA ,A.VALOR_COTAC FROM idba_komatsu.dbo.DIM_MOEDA_COTACAO A WHERE CONVERT(DATE, DATA_COTAC) = CONVERT(DATE, GETDATE() - 1)) B ON B.MOEDA = A.\\\"\\\"mo-codigo\\\"\\\"\\\"]),\\r\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(Fonte,{{\\\"NF_DATA\\\", type date}}),\\r\\n    #\\\"Inserted Merged Column\\\" = Table.AddColumn(#\\\"Changed Type\\\", \\\"Merged\\\", each Text.Combine({[DIM_EMPRESA_ID], [DIM_ITEM_ID]}), type text),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Inserted Merged Column\\\",{{\\\"Merged\\\", \\\"ID Estab\\\"}}),\\r\\n    #\\\"Consultas Mescladas\\\" = Table.NestedJoin(#\\\"Colunas Renomeadas\\\", {\\\"DIM_DIVISAO_VENDA_ID\\\"}, dDivisaoVendas, {\\\"DIM_DIVISAO_VENDA_ID\\\"}, \\\"DIVISAO VENDA\\\", JoinKind.LeftOuter),\\r\\n    #\\\"DIVISAO VENDA Expandido\\\" = Table.ExpandTableColumn(#\\\"Consultas Mescladas\\\", \\\"DIVISAO VENDA\\\", {\\\"TP_DIVISAO_VENDA\\\", \\\"DESC_AGRUP_DIVISAO_VENDA\\\"}, {\\\"DIVISAO VENDA.TP_DIVISAO_VENDA\\\", \\\"DIVISAO VENDA.DESC_AGRUP_DIVISAO_VENDA\\\"}),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"DIVISAO VENDA Expandido\\\",{{\\\"DIVISAO VENDA.TP_DIVISAO_VENDA\\\", \\\"TIPO DIVISAO\\\"}, {\\\"DIVISAO VENDA.DESC_AGRUP_DIVISAO_VENDA\\\", \\\"EMPRESA\\\"}}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Colunas Renomeadas1\\\", \\\"ID_PEDIDO\\\", each Text.Combine({[NR_PEDIDO], Text.From([NR_SEQ_PED], \\\"pt-BR\\\")}, \\\"\\\"), type text),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Coluna Mesclada Inserida\\\",{{\\\"NR_SEQ_PED\\\", type text}}),\\r\\n    //Esta personalização busca adicionar uma coluna que irá vincular com a tabela fPedidosItemMaq para levar o DT_ENTREGA e POS_PDV\\r\\n    #\\\"Personalização Adicionada\\\" = Table.AddColumn(#\\\"Tipo Alterado1\\\", \\\"chave\\\", each [NR_PEDIDO] & [NR_SEQ_PED]),\\r\\n    //Esta nova coluna servira como chave no relacionamento com a tabela dItemDemandType\\r\\n    #\\\"Personalização Adicionada1\\\" = Table.AddColumn(#\\\"Personalização Adicionada\\\", \\\"ID_CodEmpresa_ItemCode\\\", each [DIM_EMPRESA_ID] & [DIM_ITEM_ID]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada1\\\",{{\\\"chave\\\", type text}, {\\\"ID_CodEmpresa_ItemCode\\\", type text}, {\\\"DT_CANCELA_ITEM\\\", type date}})\\r\\nin\\r\\n    #\\\"Tipo Alterado\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "fVenda",
      "lineageTag": "d086cc38-1258-4cc8-bd75-25247c5973ff",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "   Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_FATO_VENDA_BI = Fonte{[Schema=\"dbo\",Item=\"FATO_VENDA_BI\"]}[Data],",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(dbo_FATO_VENDA_BI,{{\"VALOR_TOTAL\", type number}, {\"CUSTO_MATERIAL\", type number}, {\"PIS\", type number},  {\"VALOR_LIQUIDO\", type number},  {\"VALOR_IPI\", type number}, {\"CUSTO_MEDIO\", type number}, {\"PRECO_TAB\", type number}, {\"DT_EMIS\", type date}}),",
        "    #\"Linhas Classificadas\" = Table.Sort(#\"Tipo Alterado\",{{\"DT_EMIS\", Order.Descending}}),",
        "    #\"Coluna Duplicada\" = Table.DuplicateColumn(#\"Linhas Classificadas\", \"DT_EMIS\", \"DT_EMIS - Copiar\"),",
        "    #\"Nome do Mês Extraído\" = Table.TransformColumns(#\"Coluna Duplicada\", {{\"DT_EMIS - Copiar\", each Date.MonthName(_), type text}}),",
        "    #\"Texto em Maiúscula\" = Table.TransformColumns(#\"Nome do Mês Extraído\",{{\"DT_EMIS - Copiar\", Text.Upper, type text}}),",
        "    #\"Primeiros caracteres extraídos\" = Table.TransformColumns(#\"Texto em Maiúscula\", {{\"DT_EMIS - Copiar\", each Text.Start(_, 3), type text}}),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Primeiros caracteres extraídos\",{{\"DT_EMIS - Copiar\", \"DT_MES_VENDA\"}}),",
        "    #\"Coluna Duplicada1\" = Table.DuplicateColumn(#\"Colunas Renomeadas\", \"DT_EMIS\", \"DT_EMIS - Copiar\"),",
        "    #\"Ano Extraído\" = Table.TransformColumns(#\"Coluna Duplicada1\",{{\"DT_EMIS - Copiar\", Date.Year, Int64.Type}}),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"Ano Extraído\",{{\"DT_EMIS - Copiar\", \"ANO_VENDA\"}}),",
        "    #\"Coluna Duplicada2\" = Table.DuplicateColumn(#\"Colunas Renomeadas1\", \"DT_EMIS\", \"DT_EMIS - Copiar\"),",
        "    #\"Coluna Duplicada3\" = Table.DuplicateColumn(#\"Coluna Duplicada2\", \"DT_EMIS - Copiar\", \"DT_EMIS - Copiar - Copiar\"),",
        "    #\"Colunas Renomeadas2\" = Table.RenameColumns(#\"Coluna Duplicada3\",{{\"DT_EMIS - Copiar\", \"MES_NUM\"}}),",
        "    #\"Mês Extraído\" = Table.TransformColumns(#\"Colunas Renomeadas2\",{{\"MES_NUM\", Date.Month, Int64.Type}}),",
        "    #\"Dia Extraído\" = Table.TransformColumns(#\"Mês Extraído\",{{\"DT_EMIS - Copiar - Copiar\", Date.Day, Int64.Type}}),",
        "    #\"Colunas Renomeadas3\" = Table.RenameColumns(#\"Dia Extraído\",{{\"DT_EMIS - Copiar - Copiar\", \"DIA_NUM\"}}),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Colunas Renomeadas3\",{{\"DATA_PEDIDO\", type date}}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"FATO_VENDA_ID\"}),",
        "    #\"Coluna Duplicada4\" = Table.DuplicateColumn(#\"Removed Columns\", \"NOTA\", \"NOTA - Copiar\"),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Coluna Duplicada4\",{{\"NOTA - Copiar\", Int64.Type}}),",
        "    #\"Colunas Renomeadas4\" = Table.RenameColumns(#\"Tipo Alterado1\",{{\"NOTA - Copiar\", \"NOTA_INT\"}}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Colunas Renomeadas4\", \"ID_NOTA\", each Text.Combine({[DIM_EMPRESA_ID],Text.From([NOTA_INT], \"pt-BR\")}, \"\"), type text),",
        "    #\"Linhas Filtradas\" = Table.SelectRows(#\"Coluna Mesclada Inserida\", each not Text.Contains([DIM_CLIENTE_ID], \"2316\")),",
        "    #\"Coluna Mesclada Inserida1\" = Table.AddColumn(#\"Linhas Filtradas\", \"ID_PEDIDO\", each Text.Combine({[PEDIDO], Text.From([SEQUENCIA_PEDIDO], \"pt-BR\")}, \"\"), type text),",
        "    #\"Coluna Condicional Adicionada\" = Table.AddColumn(#\"Coluna Mesclada Inserida1\", \"REPRESENTANTE_ESTAB\", each if [DIM_EMPRESA_ID] = \"119\" then 34 else if [DIM_EMPRESA_ID] = \"120\" then 34 else if [DIM_EMPRESA_ID] = \"123\" then 38 else if [DIM_EMPRESA_ID] = \"110\" then 47 else if [DIM_EMPRESA_ID] = \"115\" then 12 else if [DIM_EMPRESA_ID] = \"113\" then 42 else if [DIM_EMPRESA_ID] = \"133\" then 47 else if [DIM_EMPRESA_ID] = \"134\" then 5 else null),",
        "    #\"Tipo Alterado2\" = Table.TransformColumnTypes(#\"Coluna Condicional Adicionada\",{{\"REPRESENTANTE_ESTAB\", type text}})",
        "in",
        "    #\"Tipo Alterado2\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n   Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_FATO_VENDA_BI = Fonte{[Schema=\\\"dbo\\\",Item=\\\"FATO_VENDA_BI\\\"]}[Data],\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(dbo_FATO_VENDA_BI,{{\\\"VALOR_TOTAL\\\", type number}, {\\\"CUSTO_MATERIAL\\\", type number}, {\\\"PIS\\\", type number},  {\\\"VALOR_LIQUIDO\\\", type number},  {\\\"VALOR_IPI\\\", type number}, {\\\"CUSTO_MEDIO\\\", type number}, {\\\"PRECO_TAB\\\", type number}, {\\\"DT_EMIS\\\", type date}}),\\r\\n    #\\\"Linhas Classificadas\\\" = Table.Sort(#\\\"Tipo Alterado\\\",{{\\\"DT_EMIS\\\", Order.Descending}}),\\r\\n    #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(#\\\"Linhas Classificadas\\\", \\\"DT_EMIS\\\", \\\"DT_EMIS - Copiar\\\"),\\r\\n    #\\\"Nome do Mês Extraído\\\" = Table.TransformColumns(#\\\"Coluna Duplicada\\\", {{\\\"DT_EMIS - Copiar\\\", each Date.MonthName(_), type text}}),\\r\\n    #\\\"Texto em Maiúscula\\\" = Table.TransformColumns(#\\\"Nome do Mês Extraído\\\",{{\\\"DT_EMIS - Copiar\\\", Text.Upper, type text}}),\\r\\n    #\\\"Primeiros caracteres extraídos\\\" = Table.TransformColumns(#\\\"Texto em Maiúscula\\\", {{\\\"DT_EMIS - Copiar\\\", each Text.Start(_, 3), type text}}),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Primeiros caracteres extraídos\\\",{{\\\"DT_EMIS - Copiar\\\", \\\"DT_MES_VENDA\\\"}}),\\r\\n    #\\\"Coluna Duplicada1\\\" = Table.DuplicateColumn(#\\\"Colunas Renomeadas\\\", \\\"DT_EMIS\\\", \\\"DT_EMIS - Copiar\\\"),\\r\\n    #\\\"Ano Extraído\\\" = Table.TransformColumns(#\\\"Coluna Duplicada1\\\",{{\\\"DT_EMIS - Copiar\\\", Date.Year, Int64.Type}}),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"Ano Extraído\\\",{{\\\"DT_EMIS - Copiar\\\", \\\"ANO_VENDA\\\"}}),\\r\\n    #\\\"Coluna Duplicada2\\\" = Table.DuplicateColumn(#\\\"Colunas Renomeadas1\\\", \\\"DT_EMIS\\\", \\\"DT_EMIS - Copiar\\\"),\\r\\n    #\\\"Coluna Duplicada3\\\" = Table.DuplicateColumn(#\\\"Coluna Duplicada2\\\", \\\"DT_EMIS - Copiar\\\", \\\"DT_EMIS - Copiar - Copiar\\\"),\\r\\n    #\\\"Colunas Renomeadas2\\\" = Table.RenameColumns(#\\\"Coluna Duplicada3\\\",{{\\\"DT_EMIS - Copiar\\\", \\\"MES_NUM\\\"}}),\\r\\n    #\\\"Mês Extraído\\\" = Table.TransformColumns(#\\\"Colunas Renomeadas2\\\",{{\\\"MES_NUM\\\", Date.Month, Int64.Type}}),\\r\\n    #\\\"Dia Extraído\\\" = Table.TransformColumns(#\\\"Mês Extraído\\\",{{\\\"DT_EMIS - Copiar - Copiar\\\", Date.Day, Int64.Type}}),\\r\\n    #\\\"Colunas Renomeadas3\\\" = Table.RenameColumns(#\\\"Dia Extraído\\\",{{\\\"DT_EMIS - Copiar - Copiar\\\", \\\"DIA_NUM\\\"}}),\\r\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(#\\\"Colunas Renomeadas3\\\",{{\\\"DATA_PEDIDO\\\", type date}}),\\r\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Changed Type\\\",{\\\"FATO_VENDA_ID\\\"}),\\r\\n    #\\\"Coluna Duplicada4\\\" = Table.DuplicateColumn(#\\\"Removed Columns\\\", \\\"NOTA\\\", \\\"NOTA - Copiar\\\"),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Coluna Duplicada4\\\",{{\\\"NOTA - Copiar\\\", Int64.Type}}),\\r\\n    #\\\"Colunas Renomeadas4\\\" = Table.RenameColumns(#\\\"Tipo Alterado1\\\",{{\\\"NOTA - Copiar\\\", \\\"NOTA_INT\\\"}}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Colunas Renomeadas4\\\", \\\"ID_NOTA\\\", each Text.Combine({[DIM_EMPRESA_ID],Text.From([NOTA_INT], \\\"pt-BR\\\")}, \\\"\\\"), type text),\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(#\\\"Coluna Mesclada Inserida\\\", each not Text.Contains([DIM_CLIENTE_ID], \\\"2316\\\")),\\r\\n    #\\\"Coluna Mesclada Inserida1\\\" = Table.AddColumn(#\\\"Linhas Filtradas\\\", \\\"ID_PEDIDO\\\", each Text.Combine({[PEDIDO], Text.From([SEQUENCIA_PEDIDO], \\\"pt-BR\\\")}, \\\"\\\"), type text),\\r\\n    #\\\"Coluna Condicional Adicionada\\\" = Table.AddColumn(#\\\"Coluna Mesclada Inserida1\\\", \\\"REPRESENTANTE_ESTAB\\\", each if [DIM_EMPRESA_ID] = \\\"119\\\" then 34 else if [DIM_EMPRESA_ID] = \\\"120\\\" then 34 else if [DIM_EMPRESA_ID] = \\\"123\\\" then 38 else if [DIM_EMPRESA_ID] = \\\"110\\\" then 47 else if [DIM_EMPRESA_ID] = \\\"115\\\" then 12 else if [DIM_EMPRESA_ID] = \\\"113\\\" then 42 else if [DIM_EMPRESA_ID] = \\\"133\\\" then 47 else if [DIM_EMPRESA_ID] = \\\"134\\\" then 5 else null),\\r\\n    #\\\"Tipo Alterado2\\\" = Table.TransformColumnTypes(#\\\"Coluna Condicional Adicionada\\\",{{\\\"REPRESENTANTE_ESTAB\\\", type text}})\\r\\nin\\r\\n    #\\\"Tipo Alterado2\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "fSaldoEstoque",
      "lineageTag": "284c794d-a8d0-4ec4-a7dc-f8592ca32c8d",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_FATO_SALDO_ESTOQUE = Fonte{[Schema=\"dbo\",Item=\"FATO_SALDO_ESTOQUE\"]}[Data],",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(dbo_FATO_SALDO_ESTOQUE, \"Mesclado\", each Text.Combine({[DIM_ESTABELECIMENTO_ID], [DIM_ITEM_ID]}), type text),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Mesclada Inserida\",{{\"Mesclado\", \"IDEstab\"}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Colunas Renomeadas\",{\"LOCALIZACAO\",\"CUSTO_MEDIO\",\"ID_ITEM_COMPRADO\",\"LOTE\",\"DIM_ESTABELECIMENTO_ID\",\"DEPOSITO\",\"SALDO_ALOC_PED\",\"SALDO_ALOC_PROD\",\"DIM_FORNECEDOR_ID\",\"SALDO_ALOCADO\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_FATO_SALDO_ESTOQUE = Fonte{[Schema=\\\"dbo\\\",Item=\\\"FATO_SALDO_ESTOQUE\\\"]}[Data],\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(dbo_FATO_SALDO_ESTOQUE, \\\"Mesclado\\\", each Text.Combine({[DIM_ESTABELECIMENTO_ID], [DIM_ITEM_ID]}), type text),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida\\\",{{\\\"Mesclado\\\", \\\"IDEstab\\\"}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Colunas Renomeadas\\\",{\\\"LOCALIZACAO\\\",\\\"CUSTO_MEDIO\\\",\\\"ID_ITEM_COMPRADO\\\",\\\"LOTE\\\",\\\"DIM_ESTABELECIMENTO_ID\\\",\\\"DEPOSITO\\\",\\\"SALDO_ALOC_PED\\\",\\\"SALDO_ALOC_PROD\\\",\\\"DIM_FORNECEDOR_ID\\\",\\\"SALDO_ALOCADO\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "_Medidas",
      "lineageTag": "bda2172c-2b63-476a-bf3d-4c70b762cc30",
      "text": [
        "let",
        "    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#\"Coluna 1\" = _t]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"Coluna 1\", type text}}),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Tipo Alterado\",{\"Coluna 1\"})",
        "in",
        "    #\"Colunas Removidas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\\\"i44FAA==\\\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#\\\"Coluna 1\\\" = _t]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(Fonte,{{\\\"Coluna 1\\\", type text}}),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Tipo Alterado\\\",{\\\"Coluna 1\\\"})\\r\\nin\\r\\n    #\\\"Colunas Removidas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fVendasDevolucao",
      "lineageTag": "2cf49cee-0dbb-4495-97b8-0de7b2208b8b",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "      Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_FATO_VENDA_DEV_BI = Fonte{[Schema=\"dbo\",Item=\"FATO_VENDA_DEV_BI\"]}[Data],",
        "    #\"Duplicatas Removidas\" = Table.Distinct(dbo_FATO_VENDA_DEV_BI, {\"FATO_VENDA_DEV_ID\"}),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Duplicatas Removidas\",{{\"DT_ENT_NFE\", type date}, {\"DT_EMIS_NFE\", type date}, {\"NUM_NFE\", type text}}),",
        "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Tipo Alterado1\", \"NFE_TXT\", each Text.PadStart([NUM_NFE],7,\"0\")),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Personalização Adicionada\",{{\"NUM_NFS\", type text}}),",
        "    #\"Personalização Adicionada1\" = Table.AddColumn(#\"Tipo Alterado\", \"NFS_TXT\", each Text.PadStart([NUM_NFS],7,\"0\")),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Personalização Adicionada1\",{\"FATO_VENDA_DEV_ID\"})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Removed Columns\",{\"PRECO_UNIT\",\"NFE_TXT\",\"NFS_TXT\",\"VLR_BRUTO\",\"VLR_ICMS\",\"VLR_COFINS\",\"VLR_IPI\",\"VLR_PIS\",\"DT_EMIS_NFS\",\"DT_DEVOLUCAO\",\"DT_EMIS_NFE\",\"QTDE_SAIDA\",\"TP_FRETE_NFE\",\"DIM_MOT_DEV_ID\",\"DIM_MASCARA_ID\",\"TP_FRETE_NFS\",\"column37\",\"VLR_DESC\",\"VLR_FRETE_PESO\",\"PESO_LIQ\",\"PESO_BRT\",\"PERC_COMIS\",\"VLR_FRETE\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n      Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_FATO_VENDA_DEV_BI = Fonte{[Schema=\\\"dbo\\\",Item=\\\"FATO_VENDA_DEV_BI\\\"]}[Data],\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(dbo_FATO_VENDA_DEV_BI, {\\\"FATO_VENDA_DEV_ID\\\"}),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Duplicatas Removidas\\\",{{\\\"DT_ENT_NFE\\\", type date}, {\\\"DT_EMIS_NFE\\\", type date}, {\\\"NUM_NFE\\\", type text}}),\\r\\n    #\\\"Personalização Adicionada\\\" = Table.AddColumn(#\\\"Tipo Alterado1\\\", \\\"NFE_TXT\\\", each Text.PadStart([NUM_NFE],7,\\\"0\\\")),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada\\\",{{\\\"NUM_NFS\\\", type text}}),\\r\\n    #\\\"Personalização Adicionada1\\\" = Table.AddColumn(#\\\"Tipo Alterado\\\", \\\"NFS_TXT\\\", each Text.PadStart([NUM_NFS],7,\\\"0\\\")),\\r\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Personalização Adicionada1\\\",{\\\"FATO_VENDA_DEV_ID\\\"})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Removed Columns\\\",{\\\"PRECO_UNIT\\\",\\\"NFE_TXT\\\",\\\"NFS_TXT\\\",\\\"VLR_BRUTO\\\",\\\"VLR_ICMS\\\",\\\"VLR_COFINS\\\",\\\"VLR_IPI\\\",\\\"VLR_PIS\\\",\\\"DT_EMIS_NFS\\\",\\\"DT_DEVOLUCAO\\\",\\\"DT_EMIS_NFE\\\",\\\"QTDE_SAIDA\\\",\\\"TP_FRETE_NFE\\\",\\\"DIM_MOT_DEV_ID\\\",\\\"DIM_MASCARA_ID\\\",\\\"TP_FRETE_NFS\\\",\\\"column37\\\",\\\"VLR_DESC\\\",\\\"VLR_FRETE_PESO\\\",\\\"PESO_LIQ\\\",\\\"PESO_BRT\\\",\\\"PERC_COMIS\\\",\\\"VLR_FRETE\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "FMetas",
      "lineageTag": "5a6b8cfc-5b3b-4f8b-a4cb-2c1627e88cad",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "//Ótimizamos script para pegar direto do sharepoint e não mais da pasta sincronizada.",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Metas Vendedores xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Metas Vendedores.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"Metas Vendedores xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\"),",
        "    METAS_Sheet = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"METAS\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(METAS_Sheet, [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"VALOR\", type number}, {\"Mês\", type date}, {\"Vendedor\", type text}, {\"Código\", type text}, {\"Usuário\", type text}}),",
        "    #\"Coluna Duplicada\" = Table.DuplicateColumn(#\"Tipo Alterado\", \"Vendedor\", \"Vendedor - Copiar\"),",
        "    #\"Dividir Coluna por Delimitador\" = Table.SplitColumn(#\"Coluna Duplicada\", \"Vendedor - Copiar\", Splitter.SplitTextByDelimiter(\" \", QuoteStyle.Csv), {\"Vendedor - Copiar.1\", \"Vendedor - Copiar.2\"}),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Dividir Coluna por Delimitador\",{{\"Vendedor - Copiar.1\", type text}, {\"Vendedor - Copiar.2\", type text}}),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Tipo Alterado1\",{{\"Vendedor - Copiar.1\", \"Abrev Vendedor\"}, {\"VALOR\", \"Meta\"}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Colunas Renomeadas\",{\"Usuário\",\"Abrev Vendedor\"}),",
        "    #\"Texto em Maiúscula\" = Table.TransformColumns(#\"Columns removed by Measure Killer\",{{\"Código\", Text.Upper, type text}})",
        "in",
        "#\"Texto em Maiúscula\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n//Ótimizamos script para pegar direto do sharepoint e não mais da pasta sincronizada.\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Metas Vendedores xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Metas Vendedores.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"Metas Vendedores xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\"),\\r\\n    METAS_Sheet = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"METAS\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(METAS_Sheet, [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"VALOR\\\", type number}, {\\\"Mês\\\", type date}, {\\\"Vendedor\\\", type text}, {\\\"Código\\\", type text}, {\\\"Usuário\\\", type text}}),\\r\\n    #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(#\\\"Tipo Alterado\\\", \\\"Vendedor\\\", \\\"Vendedor - Copiar\\\"),\\r\\n    #\\\"Dividir Coluna por Delimitador\\\" = Table.SplitColumn(#\\\"Coluna Duplicada\\\", \\\"Vendedor - Copiar\\\", Splitter.SplitTextByDelimiter(\\\" \\\", QuoteStyle.Csv), {\\\"Vendedor - Copiar.1\\\", \\\"Vendedor - Copiar.2\\\"}),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Dividir Coluna por Delimitador\\\",{{\\\"Vendedor - Copiar.1\\\", type text}, {\\\"Vendedor - Copiar.2\\\", type text}}),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Tipo Alterado1\\\",{{\\\"Vendedor - Copiar.1\\\", \\\"Abrev Vendedor\\\"}, {\\\"VALOR\\\", \\\"Meta\\\"}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Colunas Renomeadas\\\",{\\\"Usuário\\\",\\\"Abrev Vendedor\\\"}),\\r\\n    #\\\"Texto em Maiúscula\\\" = Table.TransformColumns(#\\\"Columns removed by Measure Killer\\\",{{\\\"Código\\\", Text.Upper, type text}})\\r\\nin\\r\\n#\\\"Texto em Maiúscula\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fMetasEstab",
      "lineageTag": "c095b551-00e6-4422-93e1-81e1e3a2d323",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "//Ótimizamos script para pegar direto do sharepoint e não mais da pasta sincronizada.",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/\", [ApiVersion = 15]),",
        "    #\"Metas Estabelecimento xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Metas Estabelecimento.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"Metas Estabelecimento xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\"),",
        "    #\"METAS-ESTAB_Sheet\" = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"METAS-ESTAB\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(#\"METAS-ESTAB_Sheet\", [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Código\", type text}, {\"Mês\", type date}, {\"Meta\", Int64.Type}}),",
        "    #\"Outras Colunas Removidas\" = Table.SelectColumns(#\"Tipo Alterado\",{\"Código\", \"Mês\", \"Meta\", \"TIPO_VENDA\"})",
        "in",
        "    #\"Outras Colunas Removidas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n//Ótimizamos script para pegar direto do sharepoint e não mais da pasta sincronizada.\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/\\\", [ApiVersion = 15]),\\r\\n    #\\\"Metas Estabelecimento xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Metas Estabelecimento.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"Metas Estabelecimento xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\"),\\r\\n    #\\\"METAS-ESTAB_Sheet\\\" = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"METAS-ESTAB\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(#\\\"METAS-ESTAB_Sheet\\\", [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"Código\\\", type text}, {\\\"Mês\\\", type date}, {\\\"Meta\\\", Int64.Type}}),\\r\\n    #\\\"Outras Colunas Removidas\\\" = Table.SelectColumns(#\\\"Tipo Alterado\\\",{\\\"Código\\\", \\\"Mês\\\", \\\"Meta\\\", \\\"TIPO_VENDA\\\"})\\r\\nin\\r\\n    #\\\"Outras Colunas Removidas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fNFVendaDev",
      "lineageTag": "a0fcb36d-502c-4837-83f4-21f6634c5079",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_FATO_NF_VENDA_DEV = Fonte{[Schema=\"dbo\",Item=\"FATO_NF_VENDA_DEV\"]}[Data],",
        "    #\"Removed Columns\" = Table.RemoveColumns(dbo_FATO_NF_VENDA_DEV,{\"FATO_NF_VENDA_DEV_ID\"})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Removed Columns\",{\"SERIE_NFE\",\"DIM_TEMPO_ID\",\"DIM_EMPRESA_ID\"})",
        "in",
        "    #\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_FATO_NF_VENDA_DEV = Fonte{[Schema=\\\"dbo\\\",Item=\\\"FATO_NF_VENDA_DEV\\\"]}[Data],\\r\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(dbo_FATO_NF_VENDA_DEV,{\\\"FATO_NF_VENDA_DEV_ID\\\"})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Removed Columns\\\",{\\\"SERIE_NFE\\\",\\\"DIM_TEMPO_ID\\\",\\\"DIM_EMPRESA_ID\\\"})\\r\\nin\\r\\n    #\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fForecastQty",
      "lineageTag": "915a41e0-476e-4075-ad21-f543614b82ae",
      "queryGroupId": "920d91f3-6d87-47c2-9b73-02ec38e39776",
      "text": [
        "let",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Mkt_Possibilities-BP21-Relatorio_BI csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Mkt_Possibilities-BP21-Relatorio_BI.csv\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"CSV Importado\" = Csv.Document(#\"Mkt_Possibilities-BP21-Relatorio_BI csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\",[Delimiter=\";\", Columns=40, Encoding=1252, QuoteStyle=QuoteStyle.None]),",
        "    #\"Tipo Alterado4\" = Table.TransformColumnTypes(#\"CSV Importado\",{{\"Column1\", type text}, {\"Column2\", type text}, {\"Column3\", type text}, {\"Column4\", type text}, {\"Column5\", type text}, {\"Column6\", type text}, {\"Column7\", type text}, {\"Column8\", type text}, {\"Column9\", type text}, {\"Column10\", type text}, {\"Column11\", type text}, {\"Column12\", type text}, {\"Column13\", type text}, {\"Column14\", type text}, {\"Column15\", type text}, {\"Column16\", type text}, {\"Column17\", type text}, {\"Column18\", type text}, {\"Column19\", type text}, {\"Column20\", type text}, {\"Column21\", type text}, {\"Column22\", type text}, {\"Column23\", type text}, {\"Column24\", type text}, {\"Column25\", type text}, {\"Column26\", type text}, {\"Column27\", type text}, {\"Column28\", type text}, {\"Column29\", type text}, {\"Column30\", type text}, {\"Column31\", type text}, {\"Column32\", type text}, {\"Column33\", type text}, {\"Column34\", type text}, {\"Column35\", type text}, {\"Column36\", type text}, {\"Column37\", type text}, {\"Column38\", type text}, {\"Column39\", type text}, {\"Column40\", type text}}),",
        "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Tipo Alterado4\", [PromoteAllScalars=true]),",
        "    #\"Outras Colunas Não Dinâmicas\" = Table.UnpivotOtherColumns(#\"Promoted Headers\", {\"Grupo de Estoque\", \"MACHINES\", \"VL UNIT\",\"VL UNIT 22\"}, \"Atributo\", \"Valor\"),",
        "    #\"Tipo Alterado2\" = Table.TransformColumnTypes(#\"Outras Colunas Não Dinâmicas\",{{\"Grupo de Estoque\", type text}}),",
        "    #\"Coluna Duplicada\" = Table.DuplicateColumn(#\"Tipo Alterado2\", \"Valor\", \"Valor - Copiar\"),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Coluna Duplicada\",{\"Valor - Copiar\"}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Colunas Removidas\", \"Mesclado\", each Text.Combine({\"0\", [Grupo de Estoque]}), type text),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Mesclada Inserida\",{{\"Mesclado\", \"GE\"}}),",
        "    #\"Coluna Mesclada Inserida1\" = Table.AddColumn(#\"Colunas Renomeadas\", \"Mesclado\", each Text.Combine({[GE], \"-\", [MACHINES]}), type text),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"Coluna Mesclada Inserida1\",{{\"Mesclado\", \"ID\"}, {\"Atributo\", \"Data\"}}),",
        "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Colunas Renomeadas1\",{{\"Data\", type date}, {\"VL UNIT\", type number}}),",
        "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Changed Type1\",{{\"Valor\", Int64.Type}, {\"VL UNIT 22\", type number}}),",
        "    #\"Personalização Adicionada1\" = Table.AddColumn(#\"Changed Type2\", \"Personalizar\", each if ([Data] >=  #date(2021,03,31) and [Data] <= #date(2022,03,01)) then \"2021\" else",
        "if ([Data] >=  #date(2022,03,31) and [Data] <= #date(2023,03,01)) then \"2022\" else \"2023\"),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Personalização Adicionada1\",{{\"Personalizar\", Int64.Type}}),",
        "    #\"Colunas Renomeadas2\" = Table.RenameColumns(#\"Tipo Alterado\",{{\"Personalizar\", \"ANO\"}}),",
        "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Colunas Renomeadas2\", \"Vl Real\", each if [ANO] = 2021 then ([VL UNIT] *1000)* [Valor]",
        "else if [ANO] = 2022 then ([VL UNIT 22]*1000) * [Valor]",
        "else 0),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Personalização Adicionada\",{{\"Vl Real\", type number}}),",
        "    #\"Erros Substituídos\" = Table.ReplaceErrorValues(#\"Tipo Alterado1\", {{\"Valor\", null}}),",
        "    #\"Erros Substituídos1\" = Table.ReplaceErrorValues(#\"Erros Substituídos\", {{\"Vl Real\", null}}),",
        "    #\"Erros Substituídos2\" = Table.ReplaceErrorValues(#\"Erros Substituídos1\", {{\"VL UNIT 22\", null}}),",
        "    #\"Erros Substituídos3\" = Table.ReplaceErrorValues(#\"Erros Substituídos2\", {{\"VL UNIT\", null}})",
        "in",
        "    #\"Erros Substituídos3\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Mkt_Possibilities-BP21-Relatorio_BI csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Mkt_Possibilities-BP21-Relatorio_BI.csv\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"CSV Importado\\\" = Csv.Document(#\\\"Mkt_Possibilities-BP21-Relatorio_BI csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\",[Delimiter=\\\";\\\", Columns=40, Encoding=1252, QuoteStyle=QuoteStyle.None]),\\r\\n    #\\\"Tipo Alterado4\\\" = Table.TransformColumnTypes(#\\\"CSV Importado\\\",{{\\\"Column1\\\", type text}, {\\\"Column2\\\", type text}, {\\\"Column3\\\", type text}, {\\\"Column4\\\", type text}, {\\\"Column5\\\", type text}, {\\\"Column6\\\", type text}, {\\\"Column7\\\", type text}, {\\\"Column8\\\", type text}, {\\\"Column9\\\", type text}, {\\\"Column10\\\", type text}, {\\\"Column11\\\", type text}, {\\\"Column12\\\", type text}, {\\\"Column13\\\", type text}, {\\\"Column14\\\", type text}, {\\\"Column15\\\", type text}, {\\\"Column16\\\", type text}, {\\\"Column17\\\", type text}, {\\\"Column18\\\", type text}, {\\\"Column19\\\", type text}, {\\\"Column20\\\", type text}, {\\\"Column21\\\", type text}, {\\\"Column22\\\", type text}, {\\\"Column23\\\", type text}, {\\\"Column24\\\", type text}, {\\\"Column25\\\", type text}, {\\\"Column26\\\", type text}, {\\\"Column27\\\", type text}, {\\\"Column28\\\", type text}, {\\\"Column29\\\", type text}, {\\\"Column30\\\", type text}, {\\\"Column31\\\", type text}, {\\\"Column32\\\", type text}, {\\\"Column33\\\", type text}, {\\\"Column34\\\", type text}, {\\\"Column35\\\", type text}, {\\\"Column36\\\", type text}, {\\\"Column37\\\", type text}, {\\\"Column38\\\", type text}, {\\\"Column39\\\", type text}, {\\\"Column40\\\", type text}}),\\r\\n    #\\\"Promoted Headers\\\" = Table.PromoteHeaders(#\\\"Tipo Alterado4\\\", [PromoteAllScalars=true]),\\r\\n    #\\\"Outras Colunas Não Dinâmicas\\\" = Table.UnpivotOtherColumns(#\\\"Promoted Headers\\\", {\\\"Grupo de Estoque\\\", \\\"MACHINES\\\", \\\"VL UNIT\\\",\\\"VL UNIT 22\\\"}, \\\"Atributo\\\", \\\"Valor\\\"),\\r\\n    #\\\"Tipo Alterado2\\\" = Table.TransformColumnTypes(#\\\"Outras Colunas Não Dinâmicas\\\",{{\\\"Grupo de Estoque\\\", type text}}),\\r\\n    #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(#\\\"Tipo Alterado2\\\", \\\"Valor\\\", \\\"Valor - Copiar\\\"),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Coluna Duplicada\\\",{\\\"Valor - Copiar\\\"}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Colunas Removidas\\\", \\\"Mesclado\\\", each Text.Combine({\\\"0\\\", [Grupo de Estoque]}), type text),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida\\\",{{\\\"Mesclado\\\", \\\"GE\\\"}}),\\r\\n    #\\\"Coluna Mesclada Inserida1\\\" = Table.AddColumn(#\\\"Colunas Renomeadas\\\", \\\"Mesclado\\\", each Text.Combine({[GE], \\\"-\\\", [MACHINES]}), type text),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida1\\\",{{\\\"Mesclado\\\", \\\"ID\\\"}, {\\\"Atributo\\\", \\\"Data\\\"}}),\\r\\n    #\\\"Changed Type1\\\" = Table.TransformColumnTypes(#\\\"Colunas Renomeadas1\\\",{{\\\"Data\\\", type date}, {\\\"VL UNIT\\\", type number}}),\\r\\n    #\\\"Changed Type2\\\" = Table.TransformColumnTypes(#\\\"Changed Type1\\\",{{\\\"Valor\\\", Int64.Type}, {\\\"VL UNIT 22\\\", type number}}),\\r\\n    #\\\"Personalização Adicionada1\\\" = Table.AddColumn(#\\\"Changed Type2\\\", \\\"Personalizar\\\", each if ([Data] >=  #date(2021,03,31) and [Data] <= #date(2022,03,01)) then \\\"2021\\\" else\\r\\nif ([Data] >=  #date(2022,03,31) and [Data] <= #date(2023,03,01)) then \\\"2022\\\" else \\\"2023\\\"),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada1\\\",{{\\\"Personalizar\\\", Int64.Type}}),\\r\\n    #\\\"Colunas Renomeadas2\\\" = Table.RenameColumns(#\\\"Tipo Alterado\\\",{{\\\"Personalizar\\\", \\\"ANO\\\"}}),\\r\\n    #\\\"Personalização Adicionada\\\" = Table.AddColumn(#\\\"Colunas Renomeadas2\\\", \\\"Vl Real\\\", each if [ANO] = 2021 then ([VL UNIT] *1000)* [Valor]\\r\\nelse if [ANO] = 2022 then ([VL UNIT 22]*1000) * [Valor]\\r\\nelse 0),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada\\\",{{\\\"Vl Real\\\", type number}}),\\r\\n    #\\\"Erros Substituídos\\\" = Table.ReplaceErrorValues(#\\\"Tipo Alterado1\\\", {{\\\"Valor\\\", null}}),\\r\\n    #\\\"Erros Substituídos1\\\" = Table.ReplaceErrorValues(#\\\"Erros Substituídos\\\", {{\\\"Vl Real\\\", null}}),\\r\\n    #\\\"Erros Substituídos2\\\" = Table.ReplaceErrorValues(#\\\"Erros Substituídos1\\\", {{\\\"VL UNIT 22\\\", null}}),\\r\\n    #\\\"Erros Substituídos3\\\" = Table.ReplaceErrorValues(#\\\"Erros Substituídos2\\\", {{\\\"VL UNIT\\\", null}})\\r\\nin\\r\\n    #\\\"Erros Substituídos3\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fForecastBudget",
      "lineageTag": "ccb34e5a-b1e3-4c03-bab5-f1480f3b0433",
      "queryGroupId": "920d91f3-6d87-47c2-9b73-02ec38e39776",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    //Atualizado 24.Out para pegar direto do sharepoint",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Linhas Filtradas\" = Table.SelectRows(Fonte, each Text.Contains([Name], \"ForecastBudgetMaquinas.xlsx\")),",
        "    #\"ForecastBudgetMaquinas xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = #\"Linhas Filtradas\"{[Name=\"ForecastBudgetMaquinas.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"ForecastBudgetMaquinas xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\"),",
        "    Sheet1_Sheet = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"Sheet1\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Estado\", type text}, {\"Consultor\", type text}, {\"Data\", type date}, {\"Quarter\", type text}, {\"Tipo\", type text}, {\"Modelo Totvs\", type text}, {\"Máquina (Fernando)\", type text}, {\"Qtd\", Int64.Type}, {\"Valor\", Int64.Type}, {\"Column10\", type any}, {\"Column11\", type any}}),",
        "    #\"Outras Colunas Removidas\" = Table.SelectColumns(#\"Tipo Alterado\",{\"Valor\", \"Qtd\", \"Máquina (Fernando)\", \"Modelo Totvs\", \"Tipo\", \"Quarter\", \"Data\", \"Consultor\", \"Estado\"})",
        "in",
        "    #\"Outras Colunas Removidas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    //Atualizado 24.Out para pegar direto do sharepoint\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(Fonte, each Text.Contains([Name], \\\"ForecastBudgetMaquinas.xlsx\\\")),\\r\\n    #\\\"ForecastBudgetMaquinas xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = #\\\"Linhas Filtradas\\\"{[Name=\\\"ForecastBudgetMaquinas.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"ForecastBudgetMaquinas xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\"),\\r\\n    Sheet1_Sheet = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"Sheet1\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"Estado\\\", type text}, {\\\"Consultor\\\", type text}, {\\\"Data\\\", type date}, {\\\"Quarter\\\", type text}, {\\\"Tipo\\\", type text}, {\\\"Modelo Totvs\\\", type text}, {\\\"Máquina (Fernando)\\\", type text}, {\\\"Qtd\\\", Int64.Type}, {\\\"Valor\\\", Int64.Type}, {\\\"Column10\\\", type any}, {\\\"Column11\\\", type any}}),\\r\\n    #\\\"Outras Colunas Removidas\\\" = Table.SelectColumns(#\\\"Tipo Alterado\\\",{\\\"Valor\\\", \\\"Qtd\\\", \\\"Máquina (Fernando)\\\", \\\"Modelo Totvs\\\", \\\"Tipo\\\", \\\"Quarter\\\", \\\"Data\\\", \\\"Consultor\\\", \\\"Estado\\\"})\\r\\nin\\r\\n    #\\\"Outras Colunas Removidas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fForecastMYO",
      "lineageTag": "93baa186-b707-4349-8877-0ab6f4a86790",
      "queryGroupId": "920d91f3-6d87-47c2-9b73-02ec38e39776",
      "text": [
        "let",
        "    //Atualizado 24.Out para pegar direto do sharepoint",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Mkt_Possibilities-MYO csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Mkt_Possibilities-MYO.csv\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"CSV Importado\" = Csv.Document(#\"Mkt_Possibilities-MYO csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\",[Delimiter=\";\", Columns=16, Encoding=1252, QuoteStyle=QuoteStyle.None]),",
        "    #\"Tipo Alterado3\" = Table.TransformColumnTypes(#\"CSV Importado\",{{\"Column1\", type text}, {\"Column2\", type text}, {\"Column3\", type text}, {\"Column4\", type text}, {\"Column5\", type text}, {\"Column6\", type text}, {\"Column7\", type text}, {\"Column8\", type text}, {\"Column9\", type text}, {\"Column10\", type text}, {\"Column11\", type text}, {\"Column12\", type text}, {\"Column13\", type text}, {\"Column14\", type text}, {\"Column15\", type text}, {\"Column16\", type text}}),",
        "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Tipo Alterado3\", [PromoteAllScalars=true]),",
        "    #\"Outras Colunas Não Dinâmicas\" = Table.UnpivotOtherColumns(#\"Promoted Headers\", {\"Grupo de Estoque\", \"MACHINES\", \"VL UNIT\",\"VL UNIT 22\"}, \"Atributo\", \"Valor\"),",
        "    #\"Tipo Alterado2\" = Table.TransformColumnTypes(#\"Outras Colunas Não Dinâmicas\",{{\"Grupo de Estoque\", type text}}),",
        "    #\"Coluna Duplicada\" = Table.DuplicateColumn(#\"Tipo Alterado2\", \"Valor\", \"Valor - Copiar\"),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Coluna Duplicada\",{\"Valor - Copiar\"}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Colunas Removidas\", \"Mesclado\", each Text.Combine({\"0\", [Grupo de Estoque]}), type text),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Mesclada Inserida\",{{\"Mesclado\", \"GE\"}}),",
        "    #\"Coluna Mesclada Inserida1\" = Table.AddColumn(#\"Colunas Renomeadas\", \"Mesclado\", each Text.Combine({[GE], \"-\", [MACHINES]}), type text),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"Coluna Mesclada Inserida1\",{{\"Mesclado\", \"ID\"}, {\"Atributo\", \"Data\"}}),",
        "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Colunas Renomeadas1\",{{\"Data\", type date}, {\"VL UNIT\", type number}}),",
        "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Changed Type1\",{{\"Valor\", Int64.Type}, {\"VL UNIT 22\", type number}}),",
        "    #\"Personalização Adicionada1\" = Table.AddColumn(#\"Changed Type2\", \"Personalizar\", each if ",
        "([Data] >=  #date(2021,03,31) ",
        " and ",
        " [Data] <= #date(2022,03,01))",
        "then \"2021\"",
        "else \"2022\"),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Personalização Adicionada1\",{{\"Personalizar\", Int64.Type}}),",
        "    #\"Colunas Renomeadas2\" = Table.RenameColumns(#\"Tipo Alterado\",{{\"Personalizar\", \"ANO\"}}),",
        "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Colunas Renomeadas2\", \"Vl Real\", each if [ANO] = 2021 then ([VL UNIT] *1000)* [Valor]",
        "else if [ANO] = 2022 then ([VL UNIT 22]*1000) * [Valor]",
        "else 0),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Personalização Adicionada\",{{\"Vl Real\", type number}}),",
        "    #\"Linhas Filtradas\" = Table.SelectRows(#\"Tipo Alterado1\", let latest = List.Max(#\"Tipo Alterado1\"[Data]) in each [Data] = latest),",
        "    #\"Linhas Filtradas1\" = Table.SelectRows(#\"Linhas Filtradas\", let earliest = List.Min(#\"Linhas Filtradas\"[Data]) in each [Data] = earliest),",
        "    #\"Linhas Filtradas2\" = Table.SelectRows(#\"Linhas Filtradas1\", let earliest = List.Min(#\"Linhas Filtradas1\"[Data]) in each [Data] = earliest),",
        "    #\"Erros Substituídos\" = Table.ReplaceErrorValues(#\"Linhas Filtradas2\", {{\"Valor\", null}}),",
        "    #\"Erros Substituídos1\" = Table.ReplaceErrorValues(#\"Erros Substituídos\", {{\"Vl Real\", null}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Erros Substituídos1\",{\"ID\",\"MACHINES\",\"GE\",\"Grupo de Estoque\",\"VL UNIT 22\",\"VL UNIT\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    //Atualizado 24.Out para pegar direto do sharepoint\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Mkt_Possibilities-MYO csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Mkt_Possibilities-MYO.csv\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"CSV Importado\\\" = Csv.Document(#\\\"Mkt_Possibilities-MYO csv_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\",[Delimiter=\\\";\\\", Columns=16, Encoding=1252, QuoteStyle=QuoteStyle.None]),\\r\\n    #\\\"Tipo Alterado3\\\" = Table.TransformColumnTypes(#\\\"CSV Importado\\\",{{\\\"Column1\\\", type text}, {\\\"Column2\\\", type text}, {\\\"Column3\\\", type text}, {\\\"Column4\\\", type text}, {\\\"Column5\\\", type text}, {\\\"Column6\\\", type text}, {\\\"Column7\\\", type text}, {\\\"Column8\\\", type text}, {\\\"Column9\\\", type text}, {\\\"Column10\\\", type text}, {\\\"Column11\\\", type text}, {\\\"Column12\\\", type text}, {\\\"Column13\\\", type text}, {\\\"Column14\\\", type text}, {\\\"Column15\\\", type text}, {\\\"Column16\\\", type text}}),\\r\\n    #\\\"Promoted Headers\\\" = Table.PromoteHeaders(#\\\"Tipo Alterado3\\\", [PromoteAllScalars=true]),\\r\\n    #\\\"Outras Colunas Não Dinâmicas\\\" = Table.UnpivotOtherColumns(#\\\"Promoted Headers\\\", {\\\"Grupo de Estoque\\\", \\\"MACHINES\\\", \\\"VL UNIT\\\",\\\"VL UNIT 22\\\"}, \\\"Atributo\\\", \\\"Valor\\\"),\\r\\n    #\\\"Tipo Alterado2\\\" = Table.TransformColumnTypes(#\\\"Outras Colunas Não Dinâmicas\\\",{{\\\"Grupo de Estoque\\\", type text}}),\\r\\n    #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(#\\\"Tipo Alterado2\\\", \\\"Valor\\\", \\\"Valor - Copiar\\\"),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Coluna Duplicada\\\",{\\\"Valor - Copiar\\\"}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Colunas Removidas\\\", \\\"Mesclado\\\", each Text.Combine({\\\"0\\\", [Grupo de Estoque]}), type text),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida\\\",{{\\\"Mesclado\\\", \\\"GE\\\"}}),\\r\\n    #\\\"Coluna Mesclada Inserida1\\\" = Table.AddColumn(#\\\"Colunas Renomeadas\\\", \\\"Mesclado\\\", each Text.Combine({[GE], \\\"-\\\", [MACHINES]}), type text),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida1\\\",{{\\\"Mesclado\\\", \\\"ID\\\"}, {\\\"Atributo\\\", \\\"Data\\\"}}),\\r\\n    #\\\"Changed Type1\\\" = Table.TransformColumnTypes(#\\\"Colunas Renomeadas1\\\",{{\\\"Data\\\", type date}, {\\\"VL UNIT\\\", type number}}),\\r\\n    #\\\"Changed Type2\\\" = Table.TransformColumnTypes(#\\\"Changed Type1\\\",{{\\\"Valor\\\", Int64.Type}, {\\\"VL UNIT 22\\\", type number}}),\\r\\n    #\\\"Personalização Adicionada1\\\" = Table.AddColumn(#\\\"Changed Type2\\\", \\\"Personalizar\\\", each if \\r\\n([Data] >=  #date(2021,03,31) \\r\\n and \\r\\n [Data] <= #date(2022,03,01))\\r\\nthen \\\"2021\\\"\\r\\nelse \\\"2022\\\"),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada1\\\",{{\\\"Personalizar\\\", Int64.Type}}),\\r\\n    #\\\"Colunas Renomeadas2\\\" = Table.RenameColumns(#\\\"Tipo Alterado\\\",{{\\\"Personalizar\\\", \\\"ANO\\\"}}),\\r\\n    #\\\"Personalização Adicionada\\\" = Table.AddColumn(#\\\"Colunas Renomeadas2\\\", \\\"Vl Real\\\", each if [ANO] = 2021 then ([VL UNIT] *1000)* [Valor]\\r\\nelse if [ANO] = 2022 then ([VL UNIT 22]*1000) * [Valor]\\r\\nelse 0),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada\\\",{{\\\"Vl Real\\\", type number}}),\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(#\\\"Tipo Alterado1\\\", let latest = List.Max(#\\\"Tipo Alterado1\\\"[Data]) in each [Data] = latest),\\r\\n    #\\\"Linhas Filtradas1\\\" = Table.SelectRows(#\\\"Linhas Filtradas\\\", let earliest = List.Min(#\\\"Linhas Filtradas\\\"[Data]) in each [Data] = earliest),\\r\\n    #\\\"Linhas Filtradas2\\\" = Table.SelectRows(#\\\"Linhas Filtradas1\\\", let earliest = List.Min(#\\\"Linhas Filtradas1\\\"[Data]) in each [Data] = earliest),\\r\\n    #\\\"Erros Substituídos\\\" = Table.ReplaceErrorValues(#\\\"Linhas Filtradas2\\\", {{\\\"Valor\\\", null}}),\\r\\n    #\\\"Erros Substituídos1\\\" = Table.ReplaceErrorValues(#\\\"Erros Substituídos\\\", {{\\\"Vl Real\\\", null}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Erros Substituídos1\\\",{\\\"ID\\\",\\\"MACHINES\\\",\\\"GE\\\",\\\"Grupo de Estoque\\\",\\\"VL UNIT 22\\\",\\\"VL UNIT\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fForecastVendedor",
      "lineageTag": "30a21a26-0619-4303-aed4-450de40ef9bd",
      "queryGroupId": "920d91f3-6d87-47c2-9b73-02ec38e39776",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    //Atualizado 24.Out para pegar direto do sharepoint",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Forecast_Vendedor xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Forecast_Vendedor.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"Forecast_Vendedor xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\"),",
        "    #\"Forecast Vendedor_Sheet\" = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"Forecast Vendedor\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(#\"Forecast Vendedor_Sheet\", [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Customers\", type text}, {\"Customer Group\", type text}, {\"UF\", type text}, {\"Group\", type text}, {\"Qty\", type number}, {\"Market Possibilities\", type number}, {\"KF Chance (Qty)\", type number}, {\"Quarter\", type text}, {\"Vendedor\", type text}, {\"Cod Representante\", type any}, {\"Preço Unitário\", Int64.Type}, {\"Grupo de Estoque\", type text}}),",
        "    #\"Coluna Duplicada\" = Table.DuplicateColumn(#\"Tipo Alterado\", \"Quarter\", \"Quarter - Copiar\"),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Coluna Duplicada\",{\"Quarter - Copiar\"}),",
        "    #\"Dividir Coluna pela Posição\" = Table.SplitColumn(#\"Colunas Removidas\", \"Quarter\", Splitter.SplitTextByRepeatedLengths(1), {\"Quarter.1\", \"Quarter.2\"}),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Dividir Coluna pela Posição\",{{\"Quarter.1\", type text}, {\"Quarter.2\", Int64.Type}}),",
        "    #\"Colunas Removidas1\" = Table.RemoveColumns(#\"Tipo Alterado1\",{\"Quarter.1\"}),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Colunas Removidas1\",{{\"Quarter.2\", \"Quarter\"}}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Colunas Renomeadas\", \"Mesclado\", each Text.Combine({\"0\", [Grupo de Estoque]}), type text),",
        "    #\"Colunas Renomeadas2\" = Table.RenameColumns(#\"Coluna Mesclada Inserida\",{{\"Mesclado\", \"GE\"}}),",
        "    #\"Colunas Removidas2\" = Table.RemoveColumns(#\"Colunas Renomeadas2\",{\"Grupo de Estoque\"}),",
        "    #\"Coluna Mesclada Inserida1\" = Table.AddColumn(#\"Colunas Removidas2\", \"Mesclado\", each Text.Combine({Text.From([Quarter], \"pt-BR\"), \"/\", Text.From([ANO FISCAL], \"pt-BR\")}), type text),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"Coluna Mesclada Inserida1\",{{\"Mesclado\", \"Quarter/Year\"}}),",
        "    #\"Tipo Alterado2\" = Table.TransformColumnTypes(#\"Colunas Renomeadas1\",{{\"ANO FISCAL\", type text}, {\"PERIODO\", type text}})",
        "in",
        "    #\"Tipo Alterado2\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    //Atualizado 24.Out para pegar direto do sharepoint\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Forecast_Vendedor xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Forecast_Vendedor.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"Forecast_Vendedor xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\"),\\r\\n    #\\\"Forecast Vendedor_Sheet\\\" = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"Forecast Vendedor\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(#\\\"Forecast Vendedor_Sheet\\\", [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"Customers\\\", type text}, {\\\"Customer Group\\\", type text}, {\\\"UF\\\", type text}, {\\\"Group\\\", type text}, {\\\"Qty\\\", type number}, {\\\"Market Possibilities\\\", type number}, {\\\"KF Chance (Qty)\\\", type number}, {\\\"Quarter\\\", type text}, {\\\"Vendedor\\\", type text}, {\\\"Cod Representante\\\", type any}, {\\\"Preço Unitário\\\", Int64.Type}, {\\\"Grupo de Estoque\\\", type text}}),\\r\\n    #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(#\\\"Tipo Alterado\\\", \\\"Quarter\\\", \\\"Quarter - Copiar\\\"),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Coluna Duplicada\\\",{\\\"Quarter - Copiar\\\"}),\\r\\n    #\\\"Dividir Coluna pela Posição\\\" = Table.SplitColumn(#\\\"Colunas Removidas\\\", \\\"Quarter\\\", Splitter.SplitTextByRepeatedLengths(1), {\\\"Quarter.1\\\", \\\"Quarter.2\\\"}),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Dividir Coluna pela Posição\\\",{{\\\"Quarter.1\\\", type text}, {\\\"Quarter.2\\\", Int64.Type}}),\\r\\n    #\\\"Colunas Removidas1\\\" = Table.RemoveColumns(#\\\"Tipo Alterado1\\\",{\\\"Quarter.1\\\"}),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Colunas Removidas1\\\",{{\\\"Quarter.2\\\", \\\"Quarter\\\"}}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Colunas Renomeadas\\\", \\\"Mesclado\\\", each Text.Combine({\\\"0\\\", [Grupo de Estoque]}), type text),\\r\\n    #\\\"Colunas Renomeadas2\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida\\\",{{\\\"Mesclado\\\", \\\"GE\\\"}}),\\r\\n    #\\\"Colunas Removidas2\\\" = Table.RemoveColumns(#\\\"Colunas Renomeadas2\\\",{\\\"Grupo de Estoque\\\"}),\\r\\n    #\\\"Coluna Mesclada Inserida1\\\" = Table.AddColumn(#\\\"Colunas Removidas2\\\", \\\"Mesclado\\\", each Text.Combine({Text.From([Quarter], \\\"pt-BR\\\"), \\\"/\\\", Text.From([ANO FISCAL], \\\"pt-BR\\\")}), type text),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida1\\\",{{\\\"Mesclado\\\", \\\"Quarter/Year\\\"}}),\\r\\n    #\\\"Tipo Alterado2\\\" = Table.TransformColumnTypes(#\\\"Colunas Renomeadas1\\\",{{\\\"ANO FISCAL\\\", type text}, {\\\"PERIODO\\\", type text}})\\r\\nin\\r\\n    #\\\"Tipo Alterado2\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Exception",
      "isHidden": false
    },
    {
      "name": "fLancamentoGerenciais",
      "lineageTag": "4f42ea79-c892-4372-a756-dfcbd8339bbb",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    //Atualizado 24.Out para pegar direto do sharepoint",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Lançamentos-Gerenciais xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Lançamentos-Gerenciais.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"Lançamentos-Gerenciais xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\"),",
        "    Dados_Sheet1 = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"Dados\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(Dados_Sheet1, [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Data\", type date}, {\"Divisão Venda\", type text}, {\"Valor\", Int64.Type}, {\"Column4\", type any}, {\"Column5\", type any}, {\"Tipo\", type text}}),",
        "    #\"Linhas Filtradas\" = Table.SelectRows(#\"Tipo Alterado\", each ([Data] <> null)),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Linhas Filtradas\",{\"Column5\", \"Tipo\"}),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Colunas Removidas\",{{\"Column4\", \"Descricao\"}})",
        "in",
        "     #\"Colunas Renomeadas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    //Atualizado 24.Out para pegar direto do sharepoint\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Lançamentos-Gerenciais xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Lançamentos-Gerenciais.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"Lançamentos-Gerenciais xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\"),\\r\\n    Dados_Sheet1 = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"Dados\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(Dados_Sheet1, [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"Data\\\", type date}, {\\\"Divisão Venda\\\", type text}, {\\\"Valor\\\", Int64.Type}, {\\\"Column4\\\", type any}, {\\\"Column5\\\", type any}, {\\\"Tipo\\\", type text}}),\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(#\\\"Tipo Alterado\\\", each ([Data] <> null)),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Linhas Filtradas\\\",{\\\"Column5\\\", \\\"Tipo\\\"}),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Colunas Removidas\\\",{{\\\"Column4\\\", \\\"Descricao\\\"}})\\r\\nin\\r\\n     #\\\"Colunas Renomeadas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fPedidoItemMaq",
      "lineageTag": "d8c1009c-c423-4491-8de4-bb4c0387527a",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "//Incluimos o valor da cotação para aba calculos na aba Machines Backlog",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\", [Query=\"SELECT A.*, B.\"\"mo-codigo\"\",C.DESCRICAO_MOEDA,C.VALOR_COTAC#(lf)FROM [idba_komatsu].[dbo].[FATO_PEDIDO_ITEM_MAQ] A#(lf)LEFT JOIN FATO_PEDIDO_BI B ON B.NR_PEDIDO = A.NR_PEDIDO#(lf)LEFT JOIN (SELECT A.MOEDA, A.DESCRICAO_MOEDA ,A.VALOR_COTAC FROM idba_komatsu.dbo.DIM_MOEDA_COTACAO A WHERE CONVERT(DATE, DATA_COTAC) = CONVERT(DATE, GETDATE() - 1)) C ON C.MOEDA = B.\"\"mo-codigo\"\"\"]),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(Fonte, \"Mesclado\", each Text.Combine({[NOTA_FISCAL], \" - \", [COD_MODELO]}), type text),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Mesclada Inserida\",{{\"Mesclado\", \"ID\"}}),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Colunas Renomeadas\",{{\"NR_PEDIDO\", type text}, {\"DIM_REPRESENTANTE_ID\", type text}}),",
        "    #\"Added Custom\" = Table.AddColumn(#\"Changed Type\", \"Pedido e Sequencia\", ",
        "each Text.Combine({",
        "Text.From([NR_PEDIDO],\"pt-BR\"),",
        "Text.From([NR_SEQUENCIA],\"pt-BR\")",
        "}),type text),",
        "    #\"Linhas Filtradas\" = Table.SelectRows(#\"Added Custom\", each true),",
        "    #\"Consultas Mescladas\" = Table.NestedJoin(#\"Linhas Filtradas\", {\"NR_PEDIDO\"}, fVenda, {\"PEDIDO\"}, \"VENDA\", JoinKind.LeftOuter),",
        "    #\"VENDA Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"VENDA\", {\"DT_EMIS\", \"NOTA\", \"VALOR_LIQUIDO\", \"DIM_DIVISAO_VENDA_ID\"}, {\"VENDA.DT_EMIS\", \"VENDA.NOTA\", \"VENDA.VALOR_LIQUIDO\", \"VENDA.DIM_DIVISAO_VENDA_ID\"}),",
        "    #\"Consultas Mescladas1\" = Table.NestedJoin(#\"VENDA Expandido\", {\"VENDA.DIM_DIVISAO_VENDA_ID\"}, dDivisaoVendas, {\"COD_DIVISAO_VENDA\"}, \"DIVISAO VENDA\", JoinKind.LeftOuter),",
        "    #\"DIVISAO VENDA Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas1\", \"DIVISAO VENDA\", {\"DESC_AGRUP_DIVISAO_VENDA\"}, {\"DIVISAO VENDA.DESC_AGRUP_DIVISAO_VENDA\"}),",
        "    #\"Duplicatas Removidas\" = Table.Distinct(#\"DIVISAO VENDA Expandido\", {\"Pedido e Sequencia\"}),",
        "    #\"Colunas Renomeadas1\" = Table.RenameColumns(#\"Duplicatas Removidas\",{{\"DIVISAO VENDA.DESC_AGRUP_DIVISAO_VENDA\", \"EMPRESA\"}, {\"VENDA.DIM_DIVISAO_VENDA_ID\", \"CANAL VENDA\"}, {\"VENDA.NOTA\", \"NOTA\"}, {\"VENDA.DT_EMIS\", \"DT EMISS VENDA\"}, {\"VENDA.VALOR_LIQUIDO\", \"VLR LIQUIDO NF\"}}),",
        "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Colunas Renomeadas1\", \"NF REAL\", each if [NOTA] <> null then [NOTA] else [NOTA_FISCAL]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Personalização Adicionada\",{{\"NF REAL\", type text}, {\"NR_SEQUENCIA\", type text}}),",
        "    //Esta personalização busca criar uma chave para vincular com a f_pedidos para trazer as colunas DT_ENTREGA e POS_PDV",
        "    #\"Personalização Adicionada1\" = Table.AddColumn(#\"Tipo Alterado\", \"chave\", each [NR_PEDIDO] & [NR_SEQUENCIA]),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Personalização Adicionada1\",{{\"chave\", type text}}),",
        "    #\"Consultas Mescladas2\" = Table.NestedJoin(#\"Tipo Alterado1\", {\"chave\"}, fPedido, {\"chave\"}, \"PEDIDO\", JoinKind.LeftOuter),",
        "    #\"PEDIDO Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas2\", \"PEDIDO\", {\"POS_PDV\", \"DT_ENTREGA\", \"DATA_ENTREGA_PED\"}, {\"PEDIDO.POS_PDV\", \"PEDIDO.DT_ENTREGA\", \"PEDIDO.DATA_ENTREGA_PED\"}),",
        "    #\"Colunas Renomeadas2\" = Table.RenameColumns(#\"PEDIDO Expandido\",{{\"PEDIDO.POS_PDV\", \"POS_PDV\"}, {\"PEDIDO.DT_ENTREGA\", \"DT_ENTREGA\"}, {\"PEDIDO.DATA_ENTREGA_PED\", \"DATA_ENTREGA_PED\"}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Colunas Renomeadas2\",{\"chave\",\"NR_PEDCLI\",\"NF REAL\",\"DESCRICAO\",\"NOTA\",\"VLR LIQUIDO NF\",\"POS_PDV\",\"CANAL VENDA\",\"NR_SEQUENCIA\",\"EMPRESA\",\"DATA_EMISSAO\",\"DATA_ENTREGA_PED\",\"DT_ENTREGA\",\"DIM_CLIENTE_ID\"})",
        ",",
        "#\"Columns removed by Measure Killer 2\"= Table.RemoveColumns(#\"Columns removed by Measure Killer\",{\"DIM_REPRESENTANTE_ID\"})",
        "in",
        "#\"Columns removed by Measure Killer 2\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n//Incluimos o valor da cotação para aba calculos na aba Machines Backlog\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\", [Query=\\\"SELECT A.*, B.\\\"\\\"mo-codigo\\\"\\\",C.DESCRICAO_MOEDA,C.VALOR_COTAC#(lf)FROM [idba_komatsu].[dbo].[FATO_PEDIDO_ITEM_MAQ] A#(lf)LEFT JOIN FATO_PEDIDO_BI B ON B.NR_PEDIDO = A.NR_PEDIDO#(lf)LEFT JOIN (SELECT A.MOEDA, A.DESCRICAO_MOEDA ,A.VALOR_COTAC FROM idba_komatsu.dbo.DIM_MOEDA_COTACAO A WHERE CONVERT(DATE, DATA_COTAC) = CONVERT(DATE, GETDATE() - 1)) C ON C.MOEDA = B.\\\"\\\"mo-codigo\\\"\\\"\\\"]),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(Fonte, \\\"Mesclado\\\", each Text.Combine({[NOTA_FISCAL], \\\" - \\\", [COD_MODELO]}), type text),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida\\\",{{\\\"Mesclado\\\", \\\"ID\\\"}}),\\r\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(#\\\"Colunas Renomeadas\\\",{{\\\"NR_PEDIDO\\\", type text}, {\\\"DIM_REPRESENTANTE_ID\\\", type text}}),\\r\\n    #\\\"Added Custom\\\" = Table.AddColumn(#\\\"Changed Type\\\", \\\"Pedido e Sequencia\\\", \\r\\neach Text.Combine({\\r\\nText.From([NR_PEDIDO],\\\"pt-BR\\\"),\\r\\nText.From([NR_SEQUENCIA],\\\"pt-BR\\\")\\r\\n}),type text),\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(#\\\"Added Custom\\\", each true),\\r\\n    #\\\"Consultas Mescladas\\\" = Table.NestedJoin(#\\\"Linhas Filtradas\\\", {\\\"NR_PEDIDO\\\"}, fVenda, {\\\"PEDIDO\\\"}, \\\"VENDA\\\", JoinKind.LeftOuter),\\r\\n    #\\\"VENDA Expandido\\\" = Table.ExpandTableColumn(#\\\"Consultas Mescladas\\\", \\\"VENDA\\\", {\\\"DT_EMIS\\\", \\\"NOTA\\\", \\\"VALOR_LIQUIDO\\\", \\\"DIM_DIVISAO_VENDA_ID\\\"}, {\\\"VENDA.DT_EMIS\\\", \\\"VENDA.NOTA\\\", \\\"VENDA.VALOR_LIQUIDO\\\", \\\"VENDA.DIM_DIVISAO_VENDA_ID\\\"}),\\r\\n    #\\\"Consultas Mescladas1\\\" = Table.NestedJoin(#\\\"VENDA Expandido\\\", {\\\"VENDA.DIM_DIVISAO_VENDA_ID\\\"}, dDivisaoVendas, {\\\"COD_DIVISAO_VENDA\\\"}, \\\"DIVISAO VENDA\\\", JoinKind.LeftOuter),\\r\\n    #\\\"DIVISAO VENDA Expandido\\\" = Table.ExpandTableColumn(#\\\"Consultas Mescladas1\\\", \\\"DIVISAO VENDA\\\", {\\\"DESC_AGRUP_DIVISAO_VENDA\\\"}, {\\\"DIVISAO VENDA.DESC_AGRUP_DIVISAO_VENDA\\\"}),\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(#\\\"DIVISAO VENDA Expandido\\\", {\\\"Pedido e Sequencia\\\"}),\\r\\n    #\\\"Colunas Renomeadas1\\\" = Table.RenameColumns(#\\\"Duplicatas Removidas\\\",{{\\\"DIVISAO VENDA.DESC_AGRUP_DIVISAO_VENDA\\\", \\\"EMPRESA\\\"}, {\\\"VENDA.DIM_DIVISAO_VENDA_ID\\\", \\\"CANAL VENDA\\\"}, {\\\"VENDA.NOTA\\\", \\\"NOTA\\\"}, {\\\"VENDA.DT_EMIS\\\", \\\"DT EMISS VENDA\\\"}, {\\\"VENDA.VALOR_LIQUIDO\\\", \\\"VLR LIQUIDO NF\\\"}}),\\r\\n    #\\\"Personalização Adicionada\\\" = Table.AddColumn(#\\\"Colunas Renomeadas1\\\", \\\"NF REAL\\\", each if [NOTA] <> null then [NOTA] else [NOTA_FISCAL]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada\\\",{{\\\"NF REAL\\\", type text}, {\\\"NR_SEQUENCIA\\\", type text}}),\\r\\n    //Esta personalização busca criar uma chave para vincular com a f_pedidos para trazer as colunas DT_ENTREGA e POS_PDV\\r\\n    #\\\"Personalização Adicionada1\\\" = Table.AddColumn(#\\\"Tipo Alterado\\\", \\\"chave\\\", each [NR_PEDIDO] & [NR_SEQUENCIA]),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada1\\\",{{\\\"chave\\\", type text}}),\\r\\n    #\\\"Consultas Mescladas2\\\" = Table.NestedJoin(#\\\"Tipo Alterado1\\\", {\\\"chave\\\"}, fPedido, {\\\"chave\\\"}, \\\"PEDIDO\\\", JoinKind.LeftOuter),\\r\\n    #\\\"PEDIDO Expandido\\\" = Table.ExpandTableColumn(#\\\"Consultas Mescladas2\\\", \\\"PEDIDO\\\", {\\\"POS_PDV\\\", \\\"DT_ENTREGA\\\", \\\"DATA_ENTREGA_PED\\\"}, {\\\"PEDIDO.POS_PDV\\\", \\\"PEDIDO.DT_ENTREGA\\\", \\\"PEDIDO.DATA_ENTREGA_PED\\\"}),\\r\\n    #\\\"Colunas Renomeadas2\\\" = Table.RenameColumns(#\\\"PEDIDO Expandido\\\",{{\\\"PEDIDO.POS_PDV\\\", \\\"POS_PDV\\\"}, {\\\"PEDIDO.DT_ENTREGA\\\", \\\"DT_ENTREGA\\\"}, {\\\"PEDIDO.DATA_ENTREGA_PED\\\", \\\"DATA_ENTREGA_PED\\\"}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Colunas Renomeadas2\\\",{\\\"chave\\\",\\\"NR_PEDCLI\\\",\\\"NF REAL\\\",\\\"DESCRICAO\\\",\\\"NOTA\\\",\\\"VLR LIQUIDO NF\\\",\\\"POS_PDV\\\",\\\"CANAL VENDA\\\",\\\"NR_SEQUENCIA\\\",\\\"EMPRESA\\\",\\\"DATA_EMISSAO\\\",\\\"DATA_ENTREGA_PED\\\",\\\"DT_ENTREGA\\\",\\\"DIM_CLIENTE_ID\\\"})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer 2\\\"= Table.RemoveColumns(#\\\"Columns removed by Measure Killer\\\",{\\\"DIM_REPRESENTANTE_ID\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer 2\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "RemoveAcento",
      "lineageTag": "b7b237ac-ee4d-4923-a01e-68018fc7dc83",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "(Texto as text) =>",
        "let",
        "    ListaAcentos = ",
        "\t\t{",
        "                {\"à\",\"a\"},",
        "                {\"á\",\"a\"},",
        "                {\"â\",\"a\"},",
        "                {\"ã\",\"a\"},",
        "                {\"ä\",\"a\"},",
        "\t\t{\"è\",\"e\"},",
        "\t\t{\"é\",\"e\"},",
        "\t\t{\"ê\",\"e\"},",
        "\t\t{\"ë\",\"e\"},",
        "\t\t{\"ì\",\"i\"},",
        "\t\t{\"í\",\"i\"},",
        "\t\t{\"î\",\"i\"},",
        "\t\t{\"ï\",\"i\"},",
        "\t\t{\"ò\",\"o\"},",
        "\t\t{\"ó\",\"o\"},",
        "\t\t{\"ô\",\"o\"},",
        "\t\t{\"õ\",\"o\"},",
        "\t\t{\"ö\",\"o\"},",
        "\t\t{\"ù\",\"u\"},",
        "\t\t{\"ú\",\"u\"},",
        "\t\t{\"û\",\"u\"},",
        "\t\t{\"ü\",\"u\"},",
        "\t\t{\"À\",\"A\"},",
        "\t\t{\"Á\",\"A\"},",
        "\t\t{\"Â\",\"A\"},",
        "\t\t{\"Ã\",\"A\"},",
        "\t\t{\"Ä\",\"A\"},",
        "\t\t{\"È\",\"E\"},",
        "\t\t{\"É\",\"E\"},",
        "\t\t{\"Ê\",\"E\"},",
        "\t\t{\"Ë\",\"E\"},",
        "\t\t{\"Ì\",\"I\"},",
        "\t\t{\"Í\",\"I\"},",
        "\t\t{\"Î\",\"I\"},",
        "\t\t{\"Ò\",\"O\"},",
        "\t\t{\"Ó\",\"O\"},",
        "\t\t{\"Ô\",\"O\"},",
        "\t\t{\"Õ\",\"O\"},",
        "\t\t{\"Ö\",\"O\"},",
        "\t\t{\"Ù\",\"U\"},",
        "\t\t{\"Ú\",\"U\"},",
        "\t\t{\"Û\",\"U\"},",
        "\t\t{\"Ü\",\"U\"},",
        "\t\t{\"ç\",\"c\"},",
        "\t\t{\"Ç\",\"C\"},",
        "\t\t{\"ñ\",\"n\"},",
        "\t\t{\"Ñ\",\"N\"}",
        "\t\t}",
        "in",
        "    Text.Combine(List.ReplaceMatchingItems(Text.ToList(Texto), ListaAcentos))"
      ],
      "loadAsTableDisabled": true,
      "resultType": "Function",
      "isHidden": false
    },
    {
      "name": "fMetasServicos",
      "lineageTag": "851977ec-e797-4a7d-bc7f-b38bbd0221e2",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "//Mudamos fonte no dia 24.10.2023 para pegar direto do sharepoint e não mais do arquivo local",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/BIFKBR-ASSISTNCIATCNICA\", [ApiVersion = 15]),",
        "    // Mudamos fonte no dia 24.10.2023 para pegar direto do sharepoint e não mais do arquivo local",
        "    #\"homologação - Metas Serviços1 xlsx_https://komatsuforest sharepoint com/sites/BIFKBR-ASSISTNCIATCNICA/Delade dokument/General/\" = Fonte{[Name=\"homologação - Metas Serviços1.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/BIFKBR-ASSISTNCIATCNICA/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"homologação - Metas Serviços1 xlsx_https://komatsuforest sharepoint com/sites/BIFKBR-ASSISTNCIATCNICA/Delade dokument/General/\"),",
        "    Planilha1_Sheet = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"Planilha1\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(Planilha1_Sheet, [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Estabelecimento\", type text}, {\"data\", type date}, {\"valor\", type number}, {\"Column4\", type any}, {\"Column5\", type any}, {\"Column6\", type any}, {\"Column7\", type any}, {\"Column8\", type any}, {\"Column9\", type any}, {\"Column10\", type any}, {\"Column11\", type any}, {\"Column12\", type any}, {\"Column13\", type any}, {\"Column14\", type any}}),",
        "    Personalizar1 = Table.SelectColumns(#\"Tipo Alterado\", {\"Estabelecimento\",\"data\",\"valor\"})",
        "in",
        "    Personalizar1"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n//Mudamos fonte no dia 24.10.2023 para pegar direto do sharepoint e não mais do arquivo local\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/BIFKBR-ASSISTNCIATCNICA\\\", [ApiVersion = 15]),\\r\\n    // Mudamos fonte no dia 24.10.2023 para pegar direto do sharepoint e não mais do arquivo local\\r\\n    #\\\"homologação - Metas Serviços1 xlsx_https://komatsuforest sharepoint com/sites/BIFKBR-ASSISTNCIATCNICA/Delade dokument/General/\\\" = Fonte{[Name=\\\"homologação - Metas Serviços1.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/BIFKBR-ASSISTNCIATCNICA/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"homologação - Metas Serviços1 xlsx_https://komatsuforest sharepoint com/sites/BIFKBR-ASSISTNCIATCNICA/Delade dokument/General/\\\"),\\r\\n    Planilha1_Sheet = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"Planilha1\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(Planilha1_Sheet, [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"Estabelecimento\\\", type text}, {\\\"data\\\", type date}, {\\\"valor\\\", type number}, {\\\"Column4\\\", type any}, {\\\"Column5\\\", type any}, {\\\"Column6\\\", type any}, {\\\"Column7\\\", type any}, {\\\"Column8\\\", type any}, {\\\"Column9\\\", type any}, {\\\"Column10\\\", type any}, {\\\"Column11\\\", type any}, {\\\"Column12\\\", type any}, {\\\"Column13\\\", type any}, {\\\"Column14\\\", type any}}),\\r\\n    Personalizar1 = Table.SelectColumns(#\\\"Tipo Alterado\\\", {\\\"Estabelecimento\\\",\\\"data\\\",\\\"valor\\\"})\\r\\nin\\r\\n    Personalizar1\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fPedidoHistorico",
      "lineageTag": "646979e8-25a8-44ac-93b6-8b04bf26301e",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    Source = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\"),",
        "    dbo_FATO_PEDIDO_HISTORICO = Source{[Schema=\"dbo\",Item=\"FATO_PEDIDO_HISTORICO\"]}[Data],",
        "    #\"Changed Type\" = Table.TransformColumnTypes(dbo_FATO_PEDIDO_HISTORICO,{{\"DT_GERACAO\", type date}, {\"DT_ENTREGA\", type date}, {\"DT_EMISSAO\", type date}}),",
        "    #\"Columns removed by Measure Killer\"= Table.RemoveColumns(#\"Changed Type\",{\"FATO_PEDIDO_ID\",\"VLR_LIQ\",\"PRECO_UNIT\",\"NR_PEDIDO_CLIENTE\",\"NR_PEDIDO\",\"DT_ENTREGA\",\"NR_SEQ_PED\",\"DIM_UNID_NEGOC_ID\",\"PRIORIDADE\",\"FATURAMENTO_PARCIAL\",\"POS_PDV\",\"QTDE_SLDO\",\"QTDE_CANC\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Source = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\"),\\r\\n    dbo_FATO_PEDIDO_HISTORICO = Source{[Schema=\\\"dbo\\\",Item=\\\"FATO_PEDIDO_HISTORICO\\\"]}[Data],\\r\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(dbo_FATO_PEDIDO_HISTORICO,{{\\\"DT_GERACAO\\\", type date}, {\\\"DT_ENTREGA\\\", type date}, {\\\"DT_EMISSAO\\\", type date}}),\\r\\n    #\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(#\\\"Changed Type\\\",{\\\"FATO_PEDIDO_ID\\\",\\\"VLR_LIQ\\\",\\\"PRECO_UNIT\\\",\\\"NR_PEDIDO_CLIENTE\\\",\\\"NR_PEDIDO\\\",\\\"DT_ENTREGA\\\",\\\"NR_SEQ_PED\\\",\\\"DIM_UNID_NEGOC_ID\\\",\\\"PRIORIDADE\\\",\\\"FATURAMENTO_PARCIAL\\\",\\\"POS_PDV\\\",\\\"QTDE_SLDO\\\",\\\"QTDE_CANC\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dMargemFamilia",
      "lineageTag": "6878d30f-ec44-4b90-b931-cdcc71faaa52",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    //Atualizado 24.Out para pegar direto do sharepoint",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\", [ApiVersion = 15]),",
        "    #\"Margem-Familia xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\" = Fonte{[Name=\"Margem-Familia.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"Margem-Familia xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\"),",
        "    Planilha1_Sheet1 = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"Planilha1\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(Planilha1_Sheet1, [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Cod.\", type text}, {\"Família Comercial\", type text}, {\"MG/2022\", type number}})",
        "in",
        "    #\"Tipo Alterado\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    //Atualizado 24.Out para pegar direto do sharepoint\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial\\\", [ApiVersion = 15]),\\r\\n    #\\\"Margem-Familia xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\" = Fonte{[Name=\\\"Margem-Familia.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/KFBR-BIComercial/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"Margem-Familia xlsx_https://komatsuforest sharepoint com/sites/KFBR-BIComercial/Delade dokument/General/\\\"),\\r\\n    Planilha1_Sheet1 = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"Planilha1\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(Planilha1_Sheet1, [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"Cod.\\\", type text}, {\\\"Família Comercial\\\", type text}, {\\\"MG/2022\\\", type number}})\\r\\nin\\r\\n    #\\\"Tipo Alterado\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "xfMachinesControl",
      "lineageTag": "a2758ce0-acab-491b-b8cc-c01a8ed317d6",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    Fonte = Excel.Workbook(File.Contents(\"\\\\brpin-inf012\\Trabalho\\Fin\\Controladoria\\2022\\ACTUAL 2022\\MONTHLY RESULTS\\RECEITA\\KFBR\\Bases de Receita\\Base Máquinas FY2022 KFBR.xlsm\"), null, true),",
        "    Database_Sheet = Fonte{[Item=\"Database\",Kind=\"Sheet\"]}[Data],",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Database_Sheet,{{\"Column1\", type any}, {\"Column2\", type any}, {\"Column3\", type any}, {\"Column4\", type any}, {\"Column5\", type any}, {\"Column6\", type any}, {\"Column7\", type text}, {\"Column8\", type any}, {\"Column9\", type text}, {\"Column10\", type text}, {\"Column11\", type text}, {\"Column12\", type any}, {\"Column13\", type any}, {\"Column14\", type any}, {\"Column15\", type any}, {\"Column16\", type any}, {\"Column17\", type any}, {\"Column18\", type any}, {\"Column19\", type any}, {\"Column20\", type any}, {\"Column21\", type any}, {\"Column22\", type any}, {\"Column23\", type any}, {\"Column24\", type any}, {\"Column25\", type any}, {\"Column26\", type any}, {\"Column27\", type any}, {\"Column28\", type any}, {\"Column29\", type any}, {\"Column30\", type any}, {\"Column31\", type any}, {\"Column32\", type any}, {\"Column33\", type any}, {\"Column34\", type text}, {\"Column35\", type any}, {\"Column36\", type text}, {\"Column37\", type text}, {\"Column38\", type text}, {\"Column39\", type any}, {\"Column40\", type any}, {\"Column41\", type any}, {\"Column42\", type any}, {\"Column43\", type text}}),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Tipo Alterado\",{\"Column1\"}),",
        "    #\"Linhas Filtradas\" = Table.SelectRows(#\"Colunas Removidas\", each ([Column2] <> null and [Column2] <> \"Database Machines KFBR - FY2022\")),",
        "    #\"Tipo Alterado1\" = Table.TransformColumnTypes(#\"Linhas Filtradas\",{{\"Column2\", type text}, {\"Column3\", type text}}),",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(#\"Tipo Alterado1\", [PromoteAllScalars=true]),",
        "    #\"Tipo Alterado2\" = Table.TransformColumnTypes(#\"Cabeçalhos Promovidos\",{{\"Serial Number\", type text}, {\"Est\", Int64.Type}, {\"Serie\", Int64.Type}, {\"Nr.#(lf)Nota\", Int64.Type}, {\"Emit\", Int64.Type}, {\"Nome\", type text}, {\"Emissão\", type date}, {\"Item\", type text}, {\"Descrição\", type text}, {\"Unid#(lf)Neg\", type text}, {\"Units\", Int64.Type}, {\"Base ICMS\", type number}, {\"%#(lf)ICMS\", type number}, {\"ICMS\", type number}, {\"Base IPI\", type number}, {\"%#(lf)IPI\", type number}, {\"IPI\", type number}, {\"Base PIS\", type number}, {\"%#(lf)PIS\", type number}, {\"PIS\", type number}, {\"Base COFINS\", type number}, {\"% COFINS\", type number}, {\"COFINS\", type number}, {\"ICMS#(lf)-ST\", Int64.Type}, {\"ICMS Part. Origem\", Int64.Type}, {\"ICMS Part. Destino\", type number}, {\"Canal#(lf)Venda\", Int64.Type}, {\"CFOP\", Int64.Type}, {\"Taxes\", type number}, {\"Gross#(lf)Sales\", type number}, {\"Net#(lf)Sales\", type number}, {\"Direct Mat Costs\", type number}, {\"Customer\", type text}, {\"Date\", type date}, {\"Cond\", type text}, {\"Equipment\", type text}, {\"Código Obsolescência de Máquina\", type text}, {\"Obsolescence\", type number}, {\"Freight\", type number}, {\"Comission\", type number}, {\"Bonus Parts\", type number}, {\"Detail\", type text}}),",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(#\"Tipo Alterado2\", \"ID_NOTA\", each Text.Combine({Text.From([Est], \"pt-BR\"), Text.From([#\"Nr.#(lf)Nota\"], \"pt-BR\")}, \"\"), type text),",
        "    #\"Valor Substituído\" = Table.ReplaceValue(#\"Coluna Mesclada Inserida\",\" \",\"\",Replacer.ReplaceText,{\"Equipment\"}),",
        "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Valor Substituído\", {\"Serial Number\"})",
        "in",
        "    #\"Duplicatas Removidas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Excel.Workbook(File.Contents(\\\"\\\\\\\\brpin-inf012\\\\Trabalho\\\\Fin\\\\Controladoria\\\\2022\\\\ACTUAL 2022\\\\MONTHLY RESULTS\\\\RECEITA\\\\KFBR\\\\Bases de Receita\\\\Base Máquinas FY2022 KFBR.xlsm\\\"), null, true),\\r\\n    Database_Sheet = Fonte{[Item=\\\"Database\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(Database_Sheet,{{\\\"Column1\\\", type any}, {\\\"Column2\\\", type any}, {\\\"Column3\\\", type any}, {\\\"Column4\\\", type any}, {\\\"Column5\\\", type any}, {\\\"Column6\\\", type any}, {\\\"Column7\\\", type text}, {\\\"Column8\\\", type any}, {\\\"Column9\\\", type text}, {\\\"Column10\\\", type text}, {\\\"Column11\\\", type text}, {\\\"Column12\\\", type any}, {\\\"Column13\\\", type any}, {\\\"Column14\\\", type any}, {\\\"Column15\\\", type any}, {\\\"Column16\\\", type any}, {\\\"Column17\\\", type any}, {\\\"Column18\\\", type any}, {\\\"Column19\\\", type any}, {\\\"Column20\\\", type any}, {\\\"Column21\\\", type any}, {\\\"Column22\\\", type any}, {\\\"Column23\\\", type any}, {\\\"Column24\\\", type any}, {\\\"Column25\\\", type any}, {\\\"Column26\\\", type any}, {\\\"Column27\\\", type any}, {\\\"Column28\\\", type any}, {\\\"Column29\\\", type any}, {\\\"Column30\\\", type any}, {\\\"Column31\\\", type any}, {\\\"Column32\\\", type any}, {\\\"Column33\\\", type any}, {\\\"Column34\\\", type text}, {\\\"Column35\\\", type any}, {\\\"Column36\\\", type text}, {\\\"Column37\\\", type text}, {\\\"Column38\\\", type text}, {\\\"Column39\\\", type any}, {\\\"Column40\\\", type any}, {\\\"Column41\\\", type any}, {\\\"Column42\\\", type any}, {\\\"Column43\\\", type text}}),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Tipo Alterado\\\",{\\\"Column1\\\"}),\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(#\\\"Colunas Removidas\\\", each ([Column2] <> null and [Column2] <> \\\"Database Machines KFBR - FY2022\\\")),\\r\\n    #\\\"Tipo Alterado1\\\" = Table.TransformColumnTypes(#\\\"Linhas Filtradas\\\",{{\\\"Column2\\\", type text}, {\\\"Column3\\\", type text}}),\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(#\\\"Tipo Alterado1\\\", [PromoteAllScalars=true]),\\r\\n    #\\\"Tipo Alterado2\\\" = Table.TransformColumnTypes(#\\\"Cabeçalhos Promovidos\\\",{{\\\"Serial Number\\\", type text}, {\\\"Est\\\", Int64.Type}, {\\\"Serie\\\", Int64.Type}, {\\\"Nr.#(lf)Nota\\\", Int64.Type}, {\\\"Emit\\\", Int64.Type}, {\\\"Nome\\\", type text}, {\\\"Emissão\\\", type date}, {\\\"Item\\\", type text}, {\\\"Descrição\\\", type text}, {\\\"Unid#(lf)Neg\\\", type text}, {\\\"Units\\\", Int64.Type}, {\\\"Base ICMS\\\", type number}, {\\\"%#(lf)ICMS\\\", type number}, {\\\"ICMS\\\", type number}, {\\\"Base IPI\\\", type number}, {\\\"%#(lf)IPI\\\", type number}, {\\\"IPI\\\", type number}, {\\\"Base PIS\\\", type number}, {\\\"%#(lf)PIS\\\", type number}, {\\\"PIS\\\", type number}, {\\\"Base COFINS\\\", type number}, {\\\"% COFINS\\\", type number}, {\\\"COFINS\\\", type number}, {\\\"ICMS#(lf)-ST\\\", Int64.Type}, {\\\"ICMS Part. Origem\\\", Int64.Type}, {\\\"ICMS Part. Destino\\\", type number}, {\\\"Canal#(lf)Venda\\\", Int64.Type}, {\\\"CFOP\\\", Int64.Type}, {\\\"Taxes\\\", type number}, {\\\"Gross#(lf)Sales\\\", type number}, {\\\"Net#(lf)Sales\\\", type number}, {\\\"Direct Mat Costs\\\", type number}, {\\\"Customer\\\", type text}, {\\\"Date\\\", type date}, {\\\"Cond\\\", type text}, {\\\"Equipment\\\", type text}, {\\\"Código Obsolescência de Máquina\\\", type text}, {\\\"Obsolescence\\\", type number}, {\\\"Freight\\\", type number}, {\\\"Comission\\\", type number}, {\\\"Bonus Parts\\\", type number}, {\\\"Detail\\\", type text}}),\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(#\\\"Tipo Alterado2\\\", \\\"ID_NOTA\\\", each Text.Combine({Text.From([Est], \\\"pt-BR\\\"), Text.From([#\\\"Nr.#(lf)Nota\\\"], \\\"pt-BR\\\")}, \\\"\\\"), type text),\\r\\n    #\\\"Valor Substituído\\\" = Table.ReplaceValue(#\\\"Coluna Mesclada Inserida\\\",\\\" \\\",\\\"\\\",Replacer.ReplaceText,{\\\"Equipment\\\"}),\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(#\\\"Valor Substituído\\\", {\\\"Serial Number\\\"})\\r\\nin\\r\\n    #\\\"Duplicatas Removidas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dCalendarioForecast",
      "lineageTag": "27a1e3ba-51c0-4de6-a5ef-6567eb2845a2",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    Fonte = fForecastVendedor,",
        "    #\"Outras Colunas Removidas\" = Table.SelectColumns(Fonte,{\"ANO FISCAL\", \"PERIODO\"}),",
        "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Outras Colunas Removidas\"),",
        "    #\"Linhas Classificadas\" = Table.Sort(#\"Duplicatas Removidas\",{{\"ANO FISCAL\", Order.Ascending}}),",
        "    #\"Coluna Duplicada\" = Table.DuplicateColumn(#\"Linhas Classificadas\", \"PERIODO\", \"PERIODO - Copiar\"),",
        "    #\"Dividir Coluna por Delimitador\" = Table.SplitColumn(#\"Coluna Duplicada\", \"PERIODO - Copiar\", Splitter.SplitTextByDelimiter(\"/\", QuoteStyle.Csv), {\"PERIODO - Copiar.1\", \"PERIODO - Copiar.2\"}),",
        "    #\"Personalização Adicionada\" = Table.AddColumn(#\"Dividir Coluna por Delimitador\", \"ORDEM\", each \"01/\" & [#\"PERIODO - Copiar.1\"] & \"/\" & [#\"PERIODO - Copiar.2\"]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Personalização Adicionada\",{{\"ORDEM\", type date}}),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Tipo Alterado\",{\"PERIODO - Copiar.1\", \"PERIODO - Copiar.2\"}),",
        "    #\"Linhas Classificadas1\" = Table.Sort(#\"Colunas Removidas\",{{\"ORDEM\", Order.Ascending}}),",
        "    #\"Linhas Filtradas\" = Table.SelectRows(#\"Linhas Classificadas1\", each ([PERIODO] <> null))",
        "in",
        "    #\"Linhas Filtradas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = fForecastVendedor,\\r\\n    #\\\"Outras Colunas Removidas\\\" = Table.SelectColumns(Fonte,{\\\"ANO FISCAL\\\", \\\"PERIODO\\\"}),\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(#\\\"Outras Colunas Removidas\\\"),\\r\\n    #\\\"Linhas Classificadas\\\" = Table.Sort(#\\\"Duplicatas Removidas\\\",{{\\\"ANO FISCAL\\\", Order.Ascending}}),\\r\\n    #\\\"Coluna Duplicada\\\" = Table.DuplicateColumn(#\\\"Linhas Classificadas\\\", \\\"PERIODO\\\", \\\"PERIODO - Copiar\\\"),\\r\\n    #\\\"Dividir Coluna por Delimitador\\\" = Table.SplitColumn(#\\\"Coluna Duplicada\\\", \\\"PERIODO - Copiar\\\", Splitter.SplitTextByDelimiter(\\\"/\\\", QuoteStyle.Csv), {\\\"PERIODO - Copiar.1\\\", \\\"PERIODO - Copiar.2\\\"}),\\r\\n    #\\\"Personalização Adicionada\\\" = Table.AddColumn(#\\\"Dividir Coluna por Delimitador\\\", \\\"ORDEM\\\", each \\\"01/\\\" & [#\\\"PERIODO - Copiar.1\\\"] & \\\"/\\\" & [#\\\"PERIODO - Copiar.2\\\"]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Personalização Adicionada\\\",{{\\\"ORDEM\\\", type date}}),\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(#\\\"Tipo Alterado\\\",{\\\"PERIODO - Copiar.1\\\", \\\"PERIODO - Copiar.2\\\"}),\\r\\n    #\\\"Linhas Classificadas1\\\" = Table.Sort(#\\\"Colunas Removidas\\\",{{\\\"ORDEM\\\", Order.Ascending}}),\\r\\n    #\\\"Linhas Filtradas\\\" = Table.SelectRows(#\\\"Linhas Classificadas1\\\", each ([PERIODO] <> null))\\r\\nin\\r\\n    #\\\"Linhas Filtradas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fOrdemManutencao",
      "lineageTag": "319d0dd9-20bb-4787-aa09-c616a970a630",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\POWERBI\", \"IDBA_KOMATSU\"),",
        "    dbo_FATO_ORDEM_MANUT = Fonte{[Schema=\"dbo\",Item=\"FATO_ORDEM_MANUT\"]}[Data],",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(dbo_FATO_ORDEM_MANUT,{{\"dat-abert\", type date}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Tipo Alterado\",{\"nr-ord-produ_1\",\"cod-eqpto\",\"dat-prev-term\",\"dat-abert\",\"dt-contato\",\"cod-tipo\",\"hr-contato\",\"cod-setor-ofici\",\"cod-estabel\",\"cod-ofici\",\"cc-codigo\",\"estado\",\"val-hodom-horim\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\POWERBI\\\", \\\"IDBA_KOMATSU\\\"),\\r\\n    dbo_FATO_ORDEM_MANUT = Fonte{[Schema=\\\"dbo\\\",Item=\\\"FATO_ORDEM_MANUT\\\"]}[Data],\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(dbo_FATO_ORDEM_MANUT,{{\\\"dat-abert\\\", type date}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Tipo Alterado\\\",{\\\"nr-ord-produ_1\\\",\\\"cod-eqpto\\\",\\\"dat-prev-term\\\",\\\"dat-abert\\\",\\\"dt-contato\\\",\\\"cod-tipo\\\",\\\"hr-contato\\\",\\\"cod-setor-ofici\\\",\\\"cod-estabel\\\",\\\"cod-ofici\\\",\\\"cc-codigo\\\",\\\"estado\\\",\\\"val-hodom-horim\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fApontamentoOrdem",
      "lineageTag": "b04de6d8-5edc-4ca8-baaa-506f88960acc",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\POWERBI\", \"IDBA_KOMATSU\"),",
        "    dbo_FATO_APONTAMENTO_MANUT = Fonte{[Schema=\"dbo\",Item=\"FATO_APONTAMENTO_MANUT\"]}[Data],",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(dbo_FATO_APONTAMENTO_MANUT,{{\"hora-ini\", type time}, {\"hora-fim\", type time}, {\"nr-ord-produ\", type text}, {\"dt-despesa\", type date}}),",
        "    #\"Início do Mês Inserido\" = Table.AddColumn(#\"Tipo Alterado\", \"Início do Mês\", each Date.StartOfMonth([#\"dt-despesa\"]), type date),",
        "    #\"Erros Substituídos\" = Table.ReplaceErrorValues(#\"Início do Mês Inserido\", {{\"hora-fim\", null}})",
        "in",
        "    #\"Erros Substituídos\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\POWERBI\\\", \\\"IDBA_KOMATSU\\\"),\\r\\n    dbo_FATO_APONTAMENTO_MANUT = Fonte{[Schema=\\\"dbo\\\",Item=\\\"FATO_APONTAMENTO_MANUT\\\"]}[Data],\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(dbo_FATO_APONTAMENTO_MANUT,{{\\\"hora-ini\\\", type time}, {\\\"hora-fim\\\", type time}, {\\\"nr-ord-produ\\\", type text}, {\\\"dt-despesa\\\", type date}}),\\r\\n    #\\\"Início do Mês Inserido\\\" = Table.AddColumn(#\\\"Tipo Alterado\\\", \\\"Início do Mês\\\", each Date.StartOfMonth([#\\\"dt-despesa\\\"]), type date),\\r\\n    #\\\"Erros Substituídos\\\" = Table.ReplaceErrorValues(#\\\"Início do Mês Inserido\\\", {{\\\"hora-fim\\\", null}})\\r\\nin\\r\\n    #\\\"Erros Substituídos\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fPedidoOrdemManutencao",
      "lineageTag": "8706f088-a478-4625-a73b-c301bd40141a",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\POWERBI\", \"IDBA_KOMATSU\"),",
        "    dbo_FATO_VENDA_ORDEM_MANUT = Fonte{[Schema=\"dbo\",Item=\"FATO_VENDA_ORDEM_MANUT\"]}[Data],",
        "    #\"Consultas Mescladas\" = Table.NestedJoin(dbo_FATO_VENDA_ORDEM_MANUT, {\"nr-pedcli\"}, fVenda, {\"PEDIDO_CLIENTE\"}, \"fVenda\", JoinKind.LeftOuter),",
        "    #\"fVenda Expandido\" = Table.ExpandTableColumn(#\"Consultas Mescladas\", \"fVenda\", {\"DT_EMIS\", \"ID_NOTA\", \"NOTA\", \"VALOR_LIQUIDO\"}, {\"fVenda.DT_EMIS\", \"fVenda.ID_NOTA\", \"fVenda.NOTA\", \"fVenda.VALOR_LIQUIDO\"}),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"fVenda Expandido\",{{\"fVenda.DT_EMIS\", type date}}),",
        "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Tipo Alterado\", {\"nr-ord-produ\"})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Duplicatas Removidas\",{\"nr-pedcli\",\"fVenda.VALOR_LIQUIDO\",\"fVenda.ID_NOTA\",\"fVenda.NOTA\",\"nome-abrev\",\"fVenda.DT_EMIS\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\POWERBI\\\", \\\"IDBA_KOMATSU\\\"),\\r\\n    dbo_FATO_VENDA_ORDEM_MANUT = Fonte{[Schema=\\\"dbo\\\",Item=\\\"FATO_VENDA_ORDEM_MANUT\\\"]}[Data],\\r\\n    #\\\"Consultas Mescladas\\\" = Table.NestedJoin(dbo_FATO_VENDA_ORDEM_MANUT, {\\\"nr-pedcli\\\"}, fVenda, {\\\"PEDIDO_CLIENTE\\\"}, \\\"fVenda\\\", JoinKind.LeftOuter),\\r\\n    #\\\"fVenda Expandido\\\" = Table.ExpandTableColumn(#\\\"Consultas Mescladas\\\", \\\"fVenda\\\", {\\\"DT_EMIS\\\", \\\"ID_NOTA\\\", \\\"NOTA\\\", \\\"VALOR_LIQUIDO\\\"}, {\\\"fVenda.DT_EMIS\\\", \\\"fVenda.ID_NOTA\\\", \\\"fVenda.NOTA\\\", \\\"fVenda.VALOR_LIQUIDO\\\"}),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"fVenda Expandido\\\",{{\\\"fVenda.DT_EMIS\\\", type date}}),\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(#\\\"Tipo Alterado\\\", {\\\"nr-ord-produ\\\"})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Duplicatas Removidas\\\",{\\\"nr-pedcli\\\",\\\"fVenda.VALOR_LIQUIDO\\\",\\\"fVenda.ID_NOTA\\\",\\\"fVenda.NOTA\\\",\\\"nome-abrev\\\",\\\"fVenda.DT_EMIS\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fApontamentoOrdemTecnico",
      "lineageTag": "9af4beef-bef0-4ec4-9a23-8d2420b112f5",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    Fonte = fApontamentoOrdem,",
        "    #\"Outras Colunas Removidas\" = Table.SelectColumns(Fonte,{\"nr-ord-produ\", \"cod-matr\"}),",
        "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Outras Colunas Removidas\", {\"nr-ord-produ\"})",
        "in",
        "    #\"Duplicatas Removidas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = fApontamentoOrdem,\\r\\n    #\\\"Outras Colunas Removidas\\\" = Table.SelectColumns(Fonte,{\\\"nr-ord-produ\\\", \\\"cod-matr\\\"}),\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(#\\\"Outras Colunas Removidas\\\", {\\\"nr-ord-produ\\\"})\\r\\nin\\r\\n    #\\\"Duplicatas Removidas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fVendaAssistencia",
      "lineageTag": "4694eb9e-0761-4df5-b57a-2ade98762f7e",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\POWERBI\", \"IDBA_KOMATSU\", [Query=\"SELECT V.[DIM_EMPRESA_ID]#(lf)      ,V.[DIM_ITEM_ID]#(lf)      ,V.[DIM_TIPO_NOTA_ID]#(lf)      ,V.[DIM_CLIENTE_ID]#(lf)      ,V.[DIM_REPRESENTANTE_ID]#(lf)      ,V.[DT_EMIS]#(lf)      ,V.[NOTA]#(lf)      ,V.[COD_ITEM]#(lf)      ,V.[VALOR_LIQUIDO]#(lf)      ,V.[COFINS]#(lf)      ,V.[PIS]#(lf)      ,V.[CUSTO_MATERIAL]#(lf)      ,V.[VALOR_TOTAL]#(lf)      ,V.[QUANTIDADE]#(lf)      ,V.[VALOR_IPI]#(lf)      ,V.[PEDIDO]#(lf)      ,V.[CUSTO_MEDIO]#(lf)      ,V.[ORIGEM]#(lf)      ,V.[ORDEM_COMPRA]#(lf)      ,V.[REPRESENTANTE]#(lf)      ,V.[PRECO_TAB]#(lf)      ,V.[TABELA_CLIENTE]#(lf)      ,V.[DIM_DIVISAO_VENDA_ID]#(lf)      ,V.[DATA_PEDIDO]#(lf)      ,V.[SEQUENCIA]#(lf)      ,V.[SEQUENCIA_PEDIDO]#(lf)      ,V.[VALOR_ICMS]#(lf)      ,V.[PEDIDO_CLIENTE]#(lf)      ,V.[SERIE]#(lf)      ,V.[SERIE_ANTECIPACAO]#(lf)      ,V.[NOTA_ANTECIPACAO]#(lf)      ,D.COD_DIVISAO_VENDA#(lf)      ,VO.[nr-ord-produ] #(lf)  FROM [idba_komatsu].[dbo].[FATO_VENDA_BI] AS V  #(lf)  INNER JOIN DIM_DIVISAO_VENDA_BI AS D on D.COD_DIVISAO_VENDA = V.DIM_DIVISAO_VENDA_ID#(lf)  INNER JOIN FATO_VENDA_ORDEM_MANUT AS VO ON VO.[nr-pedcli] = V.PEDIDO_CLIENTE#(lf)  WHERE D.TP_DIVISAO_VENDA  = 'Serviço'#(lf)\"]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"DT_EMIS\", type date}})",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Tipo Alterado\",{\"PEDIDO\",\"PEDIDO_CLIENTE\",\"PRECO_TAB\",\"NOTA\",\"VALOR_TOTAL\",\"COD_ITEM\",\"SERIE\",\"COD_DIVISAO_VENDA\",\"ORDEM_COMPRA\",\"TABELA_CLIENTE\",\"NOTA_ANTECIPACAO\",\"SERIE_ANTECIPACAO\",\"REPRESENTANTE\",\"ORIGEM\",\"DATA_PEDIDO\",\"SEQUENCIA\",\"SEQUENCIA_PEDIDO\",\"PIS\",\"CUSTO_MATERIAL\",\"QUANTIDADE\",\"VALOR_IPI\",\"COFINS\",\"CUSTO_MEDIO\",\"VALOR_ICMS\"}),",
        "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Columns removed by Measure Killer\")",
        "in",
        "    #\"Duplicatas Removidas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\POWERBI\\\", \\\"IDBA_KOMATSU\\\", [Query=\\\"SELECT V.[DIM_EMPRESA_ID]#(lf)      ,V.[DIM_ITEM_ID]#(lf)      ,V.[DIM_TIPO_NOTA_ID]#(lf)      ,V.[DIM_CLIENTE_ID]#(lf)      ,V.[DIM_REPRESENTANTE_ID]#(lf)      ,V.[DT_EMIS]#(lf)      ,V.[NOTA]#(lf)      ,V.[COD_ITEM]#(lf)      ,V.[VALOR_LIQUIDO]#(lf)      ,V.[COFINS]#(lf)      ,V.[PIS]#(lf)      ,V.[CUSTO_MATERIAL]#(lf)      ,V.[VALOR_TOTAL]#(lf)      ,V.[QUANTIDADE]#(lf)      ,V.[VALOR_IPI]#(lf)      ,V.[PEDIDO]#(lf)      ,V.[CUSTO_MEDIO]#(lf)      ,V.[ORIGEM]#(lf)      ,V.[ORDEM_COMPRA]#(lf)      ,V.[REPRESENTANTE]#(lf)      ,V.[PRECO_TAB]#(lf)      ,V.[TABELA_CLIENTE]#(lf)      ,V.[DIM_DIVISAO_VENDA_ID]#(lf)      ,V.[DATA_PEDIDO]#(lf)      ,V.[SEQUENCIA]#(lf)      ,V.[SEQUENCIA_PEDIDO]#(lf)      ,V.[VALOR_ICMS]#(lf)      ,V.[PEDIDO_CLIENTE]#(lf)      ,V.[SERIE]#(lf)      ,V.[SERIE_ANTECIPACAO]#(lf)      ,V.[NOTA_ANTECIPACAO]#(lf)      ,D.COD_DIVISAO_VENDA#(lf)      ,VO.[nr-ord-produ] #(lf)  FROM [idba_komatsu].[dbo].[FATO_VENDA_BI] AS V  #(lf)  INNER JOIN DIM_DIVISAO_VENDA_BI AS D on D.COD_DIVISAO_VENDA = V.DIM_DIVISAO_VENDA_ID#(lf)  INNER JOIN FATO_VENDA_ORDEM_MANUT AS VO ON VO.[nr-pedcli] = V.PEDIDO_CLIENTE#(lf)  WHERE D.TP_DIVISAO_VENDA  = 'Serviço'#(lf)\\\"]),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(Fonte,{{\\\"DT_EMIS\\\", type date}})\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Tipo Alterado\\\",{\\\"PEDIDO\\\",\\\"PEDIDO_CLIENTE\\\",\\\"PRECO_TAB\\\",\\\"NOTA\\\",\\\"VALOR_TOTAL\\\",\\\"COD_ITEM\\\",\\\"SERIE\\\",\\\"COD_DIVISAO_VENDA\\\",\\\"ORDEM_COMPRA\\\",\\\"TABELA_CLIENTE\\\",\\\"NOTA_ANTECIPACAO\\\",\\\"SERIE_ANTECIPACAO\\\",\\\"REPRESENTANTE\\\",\\\"ORIGEM\\\",\\\"DATA_PEDIDO\\\",\\\"SEQUENCIA\\\",\\\"SEQUENCIA_PEDIDO\\\",\\\"PIS\\\",\\\"CUSTO_MATERIAL\\\",\\\"QUANTIDADE\\\",\\\"VALOR_IPI\\\",\\\"COFINS\\\",\\\"CUSTO_MEDIO\\\",\\\"VALOR_ICMS\\\"}),\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(#\\\"Columns removed by Measure Killer\\\")\\r\\nin\\r\\n    #\\\"Duplicatas Removidas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "fCotação",
      "lineageTag": "d231bf0b-e3d4-4581-b7d1-299703ec028f",
      "queryGroupId": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    Fonte = Sql.Databases(\"BRPIN-DBS008\\PowerBI\"),",
        "    idba_komatsu = Fonte{[Name=\"idba_komatsu\"]}[Data],",
        "    dbo_FATO_COTACAO_BI = idba_komatsu{[Schema=\"dbo\",Item=\"FATO_COTACAO_BI\"]}[Data]",
        "in",
        "    dbo_FATO_COTACAO_BI"
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Databases(\\\"BRPIN-DBS008\\\\PowerBI\\\"),\\r\\n    idba_komatsu = Fonte{[Name=\\\"idba_komatsu\\\"]}[Data],\\r\\n    dbo_FATO_COTACAO_BI = idba_komatsu{[Schema=\\\"dbo\\\",Item=\\\"FATO_COTACAO_BI\\\"]}[Data]\\r\\nin\\r\\n    dbo_FATO_COTACAO_BI\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dEmitente",
      "lineageTag": "d70aae1b-834d-4f10-a0e5-9f7b1054147d",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = Sql.Database(\"10.105.40.196\\POWERBI\", \"IDBA_KOMATSU\"),",
        "    dbo_DIM_EMITENTE_BI = Fonte{[Schema=\"dbo\",Item=\"DIM_EMITENTE_BI\"]}[Data],",
        "    #\"Coluna Mesclada Inserida\" = Table.AddColumn(dbo_DIM_EMITENTE_BI, \"Mesclado\", each Text.Combine({Text.From([COD_EMITENTE], \"pt-BR\"), \" - \", [NOME]}), type text),",
        "    #\"Colunas Renomeadas\" = Table.RenameColumns(#\"Coluna Mesclada Inserida\",{{\"Mesclado\", \"COD_EMITENTE_NOME\"}}),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(#\"Colunas Renomeadas\",{{\"COD_EMITENTE\", type text}})",
        "in",
        "    #\"Tipo Alterado\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\POWERBI\\\", \\\"IDBA_KOMATSU\\\"),\\r\\n    dbo_DIM_EMITENTE_BI = Fonte{[Schema=\\\"dbo\\\",Item=\\\"DIM_EMITENTE_BI\\\"]}[Data],\\r\\n    #\\\"Coluna Mesclada Inserida\\\" = Table.AddColumn(dbo_DIM_EMITENTE_BI, \\\"Mesclado\\\", each Text.Combine({Text.From([COD_EMITENTE], \\\"pt-BR\\\"), \\\" - \\\", [NOME]}), type text),\\r\\n    #\\\"Colunas Renomeadas\\\" = Table.RenameColumns(#\\\"Coluna Mesclada Inserida\\\",{{\\\"Mesclado\\\", \\\"COD_EMITENTE_NOME\\\"}}),\\r\\n    #\\\"Tipo Alterado\\\" = Table.TransformColumnTypes(#\\\"Colunas Renomeadas\\\",{{\\\"COD_EMITENTE\\\", type text}})\\r\\nin\\r\\n    #\\\"Tipo Alterado\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dSyncron",
      "lineageTag": "25e60683-d224-45ec-9fde-fd48169792e4",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/BIKFBR-Logstica\", [ApiVersion = 15]),",
        "    #\"Base Syncron xlsx_https://komatsuforest.sharepoint.com/sites/BIKFBR-Logstica/Delade dokument/General/\" = Fonte{[Name=\"PBI_base_tratada_syncron.xlsx\",#\"Folder Path\"=\"https://komatsuforest.sharepoint.com/sites/BIKFBR-Logstica/Delade dokument/General/\"]}[Content],",
        "    #\"Pasta de Trabalho Importada do Excel\" = Excel.Workbook(#\"Base Syncron xlsx_https://komatsuforest.sharepoint.com/sites/BIKFBR-Logstica/Delade dokument/General/\"),",
        "    Sheet1_Sheet = #\"Pasta de Trabalho Importada do Excel\"{[Item=\"Sheet1\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    #\"Cabeçalhos Promovidos\",{\"Item_Code\",\"Warehouse name\",\"VAU class\",\"Vau_Class_2\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = SharePoint.Files(\\\"https://komatsuforest.sharepoint.com/sites/BIKFBR-Logstica\\\", [ApiVersion = 15]),\\r\\n    #\\\"Base Syncron xlsx_https://komatsuforest.sharepoint.com/sites/BIKFBR-Logstica/Delade dokument/General/\\\" = Fonte{[Name=\\\"PBI_base_tratada_syncron.xlsx\\\",#\\\"Folder Path\\\"=\\\"https://komatsuforest.sharepoint.com/sites/BIKFBR-Logstica/Delade dokument/General/\\\"]}[Content],\\r\\n    #\\\"Pasta de Trabalho Importada do Excel\\\" = Excel.Workbook(#\\\"Base Syncron xlsx_https://komatsuforest.sharepoint.com/sites/BIKFBR-Logstica/Delade dokument/General/\\\"),\\r\\n    Sheet1_Sheet = #\\\"Pasta de Trabalho Importada do Excel\\\"{[Item=\\\"Sheet1\\\",Kind=\\\"Sheet\\\"]}[Data],\\r\\n    #\\\"Cabeçalhos Promovidos\\\" = Table.PromoteHeaders(Sheet1_Sheet, [PromoteAllScalars=true])\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    #\\\"Cabeçalhos Promovidos\\\",{\\\"Item_Code\\\",\\\"Warehouse name\\\",\\\"VAU class\\\",\\\"Vau_Class_2\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "dMoeda",
      "lineageTag": "127c474c-73d0-43de-a30c-86aac7e7e1eb",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "text": [
        "let",
        "//Incluimos valor da cotação para usar na aba machines Backlog",
        "    Fonte = Sql.Database(\"10.105.40.196\\powerbi\", \"idba_komatsu\", [Query=\"SELECT A.MOEDA, A.DESCRICAO_MOEDA ,A.VALOR_COTAC#(lf)FROM [idba_komatsu].[dbo].[DIM_MOEDA_COTACAO] A#(lf)WHERE CONVERT(DATE, DATA_COTAC) = CONVERT(DATE, GETDATE() - 1)\"])",
        ",",
        "#\"Columns removed by Measure Killer\"= Table.RemoveColumns(    Fonte,{\"MOEDA\"})",
        "in",
        "#\"Columns removed by Measure Killer\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n//Incluimos valor da cotação para usar na aba machines Backlog\\r\\n    Fonte = Sql.Database(\\\"10.105.40.196\\\\powerbi\\\", \\\"idba_komatsu\\\", [Query=\\\"SELECT A.MOEDA, A.DESCRICAO_MOEDA ,A.VALOR_COTAC#(lf)FROM [idba_komatsu].[dbo].[DIM_MOEDA_COTACAO] A#(lf)WHERE CONVERT(DATE, DATA_COTAC) = CONVERT(DATE, GETDATE() - 1)\\\"])\\r\\n,\\r\\n#\\\"Columns removed by Measure Killer\\\"= Table.RemoveColumns(    Fonte,{\\\"MOEDA\\\"})\\r\\nin\\r\\n#\\\"Columns removed by Measure Killer\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Parâmetro1",
      "lineageTag": "e331f654-61eb-441f-8291-f8aa68dc917d",
      "queryGroupId": "cf09a168-f913-4bc8-8bcd-a7e0baca2a73",
      "text": [
        "#\"Arquivo de Amostra\" meta [IsParameterQuery=true, BinaryIdentifier=#\"Arquivo de Amostra\", Type=\"Binary\", IsParameterQueryRequired=true]"
      ],
      "loadAsTableDisabled": true,
      "resultType": "Binary",
      "isHidden": false
    },
    {
      "name": "Transformar o Arquivo de Exemplo",
      "lineageTag": "b7e40530-7500-4947-b915-3c93270e48f1",
      "queryGroupId": "cd8d0dfa-39aa-46d0-b7c9-f1fb1ee228cc",
      "text": [
        "let",
        "    Fonte = Excel.Workbook(Parâmetro1, null, true),",
        "    #\"Classificação dos Cliente_Sheet\" = Fonte{[Item=\"Classificação dos Cliente\",Kind=\"Sheet\"]}[Data],",
        "    #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(#\"Classificação dos Cliente_Sheet\", [PromoteAllScalars=true])",
        "in",
        "    #\"Cabeçalhos Promovidos\""
      ],
      "loadAsTableDisabled": true,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Arquivo de Amostra",
      "lineageTag": "d0ad24fc-6ad9-405c-87ff-527481f49a75",
      "queryGroupId": "cf09a168-f913-4bc8-8bcd-a7e0baca2a73",
      "text": [
        "let",
        "    Fonte = SharePoint.Files(\"https://komatsuforest.sharepoint.com/sites/BIKFBR-ANLISEDEMARGENS\", [ApiVersion = 15]),",
        "    Navegação1 = Fonte{0}[Content]",
        "in",
        "    Navegação1"
      ],
      "loadAsTableDisabled": true,
      "resultType": "Binary",
      "isHidden": false
    },
    {
      "name": "Transformar Arquivo",
      "lineageTag": "653f1d79-8070-445c-879f-7c67ea4c7fe4",
      "queryGroupId": "cf09a168-f913-4bc8-8bcd-a7e0baca2a73",
      "text": [
        "let",
        "    Fonte = (Parâmetro1 as binary) => let",
        "        Fonte = Excel.Workbook(Parâmetro1, null, true),",
        "        #\"Classificação dos Cliente_Sheet\" = Fonte{[Item=\"Classificação dos Cliente\",Kind=\"Sheet\"]}[Data],",
        "        #\"Cabeçalhos Promovidos\" = Table.PromoteHeaders(#\"Classificação dos Cliente_Sheet\", [PromoteAllScalars=true])",
        "    in",
        "        #\"Cabeçalhos Promovidos\"",
        "in",
        "    Fonte"
      ],
      "loadAsTableDisabled": true,
      "resultType": "Function",
      "isHidden": false
    },
    {
      "name": "dMotivoCancelamento",
      "lineageTag": "1ae9a4cd-d188-444f-8051-a694421f2d62",
      "queryGroupId": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "navigationStepName": "Navegação",
      "text": [
        "let",
        "    Fonte = Sql.Databases(\"BRPIN-DBS008\\PowerBI\"),",
        "    idba_komatsu = Fonte{[Name=\"idba_komatsu\"]}[Data],",
        "    dbo_DIM_MOTIVO_CANC = idba_komatsu{[Schema=\"dbo\",Item=\"DIM_MOTIVO_CANC\"]}[Data],",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(dbo_DIM_MOTIVO_CANC,{\"NARRATIVA\", \"TIPO_TRANS\"}),",
        "    #\"Valor Substituído\" = Table.ReplaceValue(#\"Colunas Removidas\",\"NAO USAR\",\"NÃO USAR\",Replacer.ReplaceText,{\"DESCRICAO\"}),",
        "    #\"Valor Substituído1\" = Table.ReplaceValue(#\"Valor Substituído\",\".\",\"\",Replacer.ReplaceText,{\"DESCRICAO\"}),",
        "    #\"Valor Substituído2\" = Table.ReplaceValue(#\"Valor Substituído1\",\"-\",\"\",Replacer.ReplaceText,{\"DESCRICAO\"}),",
        "    #\"Duplicatas Removidas\" = Table.Distinct(#\"Valor Substituído2\")",
        "in",
        "    #\"Duplicatas Removidas\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\r\\n    Fonte = Sql.Databases(\\\"BRPIN-DBS008\\\\PowerBI\\\"),\\r\\n    idba_komatsu = Fonte{[Name=\\\"idba_komatsu\\\"]}[Data],\\r\\n    dbo_DIM_MOTIVO_CANC = idba_komatsu{[Schema=\\\"dbo\\\",Item=\\\"DIM_MOTIVO_CANC\\\"]}[Data],\\r\\n    #\\\"Colunas Removidas\\\" = Table.RemoveColumns(dbo_DIM_MOTIVO_CANC,{\\\"NARRATIVA\\\", \\\"TIPO_TRANS\\\"}),\\r\\n    #\\\"Valor Substituído\\\" = Table.ReplaceValue(#\\\"Colunas Removidas\\\",\\\"NAO USAR\\\",\\\"NÃO USAR\\\",Replacer.ReplaceText,{\\\"DESCRICAO\\\"}),\\r\\n    #\\\"Valor Substituído1\\\" = Table.ReplaceValue(#\\\"Valor Substituído\\\",\\\".\\\",\\\"\\\",Replacer.ReplaceText,{\\\"DESCRICAO\\\"}),\\r\\n    #\\\"Valor Substituído2\\\" = Table.ReplaceValue(#\\\"Valor Substituído1\\\",\\\"-\\\",\\\"\\\",Replacer.ReplaceText,{\\\"DESCRICAO\\\"}),\\r\\n    #\\\"Duplicatas Removidas\\\" = Table.Distinct(#\\\"Valor Substituído2\\\")\\r\\nin\\r\\n    #\\\"Duplicatas Removidas\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "MEDIDAS NOTAS",
      "lineageTag": "9f311d21-6ced-4ce2-90e5-6e19b6061a56",
      "text": [
        "let",
        "    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [#\"Coluna 1\" = _t]),",
        "    #\"Tipo Alterado\" = Table.TransformColumnTypes(Fonte,{{\"Coluna 1\", type text}}),",
        "    #\"Colunas Removidas\" = Table.RemoveColumns(#\"Tipo Alterado\",{\"Coluna 1\"})",
        "in",
        "    #\"Colunas Removidas\""
      ],
      "loadAsTableDisabled": true,
      "resultType": "Table",
      "isHidden": false
    }
  ],
  "queryGroups": [
    {
      "name": "DIM",
      "id": "c6ef796c-345c-4f84-a0c2-f467af6a044e",
      "order": 2,
      "description": ""
    },
    {
      "name": "FATO",
      "id": "1ff7e936-08b8-4f50-b390-df49c63d83c2",
      "description": ""
    },
    {
      "name": "Budget Machines",
      "id": "920d91f3-6d87-47c2-9b73-02ec38e39776",
      "order": 1,
      "description": ""
    },
    {
      "name": "Transformar Arquivo de dTipoDeContaCliente",
      "id": "cd8d0dfa-39aa-46d0-b7c9-f1fb1ee228cc",
      "description": "",
      "parentId": "c6ef796c-345c-4f84-a0c2-f467af6a044e"
    },
    {
      "name": "Consultas Auxiliares",
      "id": "cf09a168-f913-4bc8-8bcd-a7e0baca2a73",
      "description": "",
      "parentId": "cd8d0dfa-39aa-46d0-b7c9-f1fb1ee228cc"
    }
  ],
  "culture": "pt-BR",
  "firewallEnabled": true
}